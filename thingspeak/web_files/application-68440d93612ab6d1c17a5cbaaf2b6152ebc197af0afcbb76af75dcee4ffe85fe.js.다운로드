function unbindBeforeUnloadEvents(){$(window).unbind("beforeunload.channel"),$(document).unbind("page:before-change.channel page:before-unload.channel")}function confirmUnsavedChanges(){var e=$("#unsaved_message").val(),t=channelInfo();unbindBeforeUnloadEvents(),$(window).bind("beforeunload.channel",function(){if(channelChanged(t))return e}),$(document).bind("page:before-change.channel page:before-unload.channel",function(){if(channelChanged(t)&&!confirm(e))return!1})}function channelInfo(){var e=$(":text").get(),t=$(":radio:checked").get(),n=$(":checkbox").get();return[e,$("textarea").get(),t,n].map(function(e){return e.map(function(e){return e.value})}).reduce(function(e,t){return e.concat(t)})}function channelChanged(e){if(!elementPresent($("#channel_form")))return!1;if("/channels/new"===window.location.pathname)return!0;var t=channelInfo();if(e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!0;return!1}function setSchedulable(){switch($("#schedulable_templates").append($(".schedulable_template")),$("#schedulable").html(""),$("#timecontrol_schedulable_type").val()){case"Thinghttp":$("#schedulable").append($("#thinghttp_template")),disableDateTime(!1);break;case"Talkback":$("#schedulable").append($("#talkback_template")),disableDateTime(!1);break;case"MatlabCode":$("#schedulable").append($("#matlab_code_template")),!0===$("#timecontrol_frequency_hourly").prop("checked")||!0===$("#timecontrol_frequency_minutes").prop("checked")?disableDateTime(!0):disableDateTime(!1);break;case"MatlabIotAnalytic":ThingSpeak.MatlabIotAnalyticUtility.getMATLABFileNames(),$("#schedulable").append($("#matlab_iot_analytic_template")),!0===$("#timecontrol_frequency_hourly").prop("checked")||!0===$("#timecontrol_frequency_minutes").prop("checked")?disableDateTime(!0):disableDateTime(!1)}""!==$("#schedulable option:selected").text()?$("#timecontrol-save-button").removeAttr("disabled"):$("#timecontrol-save-button").attr("disabled",!0)}function setWeekdays(){var e=$("#saved_weekdays").val();e.length>0&&$.each(e.split(" "),function(e,t){$('.weekdays[value="'+t+'"]').prop("checked",!0)})}function fixDateTime(){var e=$("#timecontrol_run_at").val(),t=$("#saved_hour").val();if(e.length>0){var n=e.split(" ");$("#timecontrol_run_at").val(n[0])}if(t.length>0){var i=t.split(" ");$("#hour").val(i[0]),$("#minute").val($("#saved_minute").val()),$("#ampm").val(i[1])}}function getStartTime(){$.ajax({url:"calculate_start_time",success:function(e){var t=e.start_time;$("#hour").val(parseInt(t.substring(0,2),10)),$("#minute").val(t.substring(3,5)),$("#second").val(t.substring(6,8)),$("#ampm").val(t.substring(9).toLowerCase()),$("#minute_start_time").text($("#hour").val()+":"+$("#minute").val()+" "+$("#ampm").val())}})}function disableDateTime(e){e?(getStartTime(),$("#frequency_div_time").hide(),$("#frequency_div_start_time").show()):($("#frequency_div_time").show(),$("#frequency_div_start_time").hide())}function recurrancyHandler(){!0===$("#timecontrol_frequency_weekly").prop("checked")?($("#frequency_once_div").hide(),$("#frequency_recurring_div_days").removeClass("d-none"),$("#frequency_recurring_div_hours").addClass("d-none"),$("#frequency_recurring_div_minutes").addClass("d-none"),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").removeClass("d-none"),setTimeLabel("Time"),disableDateTime(!1)):!0===$("#timecontrol_frequency_daily").prop("checked")?($("#frequency_once_div").hide(),$("#frequency_recurring_div_hours").addClass("d-none"),$("#frequency_recurring_div_minutes").addClass("d-none"),$("#frequency_recurring_div_days").addClass("d-none"),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").removeClass("d-none"),setTimeLabel("Time"),disableDateTime(!1)):!0===$("#timecontrol_frequency_hourly").prop("checked")?($("#frequency_once_div").hide(),$("#frequency_recurring_div_days").addClass("d-none"),$("#frequency_recurring_div_minutes").addClass("d-none"),$("#frequency_recurring_div_hours").removeClass("d-none"),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").removeClass("d-none"),"MatlabCode"===$("#timecontrol_schedulable_type").val()||"MatlabIotAnalytic"===$("#timecontrol_schedulable_type").val()?disableDateTime(!0):disableDateTime(!1),setTimeLabel("Start Time")):!0===$("#timecontrol_frequency_minutes").prop("checked")&&($("#frequency_once_div").hide(),$("#frequency_recurring_div_days").addClass("d-none"),$("#frequency_recurring_div_hours").addClass("d-none"),$("#frequency_recurring_div_minutes").removeClass("d-none"),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").removeClass("d-none"),"MatlabCode"===$("#timecontrol_schedulable_type").val()||"MatlabIotAnalytic"===$("#timecontrol_schedulable_type").val()?disableDateTime(!0):disableDateTime(!1),setTimeLabel("Start Time")),displayFuzzyTimeOptions()}function setTimeLabel(e){$("#time_label").text(e)}function setWeekdays(){var e=$("#saved_weekdays").val();e.length>0&&$.each(e.split(" "),function(e,t){$('.weekdays[value="'+t+'"]').prop("checked",!0)})}function setFrequencyOption(){!0===$("#timecontrol_frequency_weekly").prop("checked")||!0===$("#timecontrol_frequency_daily").prop("checked")||!0===$("#timecontrol_frequency_hourly").prop("checked")||!0===$("#timecontrol_frequency_minutes").prop("checked")?$("#frequency_recurrance").attr("checked",!0):$("#frequency_once").attr("checked",!0),frequencyHandler()}function frequencyHandler(){!0===$("#frequency_once").prop("checked")?($("#frequency_recurring_div").addClass("d-none"),$("#frequency_once_div").show(),$("#frequency_recurring_div_choice").addClass("d-none"),$("#frequency_once_div_date").show(),$("#frequency_recurring_div_hours").addClass("d-none"),$("#frequency_recurring_div_minutes").addClass("d-none"),$("#frequency_recurring_div_days").addClass("d-none"),setTimeLabel("Time"),disableDateTime(!1)):!0===$("#frequency_recurrance").prop("checked")&&($("#frequency_once_div").hide(),$("#frequency_recurring_div").removeClass("d-none"),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").removeClass("d-none"),$("input:radio[class='recurrance_radio']").is(":checked")||$("#timecontrol_frequency_weekly").attr("checked",!0),recurrancyHandler())}function displayFuzzyTimeOptions(){if(!0===$("#timecontrol_frequency_minutes").prop("checked")&&!1===$("#frequency_once").prop("checked")){recurring_minute=$("#timecontrol_recurring_minute").prop("selectedOptions")[0];var e=recurring_minute.value/2;e*=60,$("#fuzzy_time option").each(function(){$(this).val()<e?$(this).show():$(this).hide()}),$("#fuzzy_time").val($("#fuzzy_time option:first").val())}else $("#fuzzy_time option").each(function(){$(this).show()})}!function(){"use strict";var e=function(e,t){var n;e.rails!==t&&e.error("jquery-ujs has already been loaded!");var i=e(document);e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not([form]):not(form button), button[data-confirm]:not([form]):not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form:not([data-turbo=true])",formInputClickSelector:"form:not([data-turbo=true]) input[type=submit], form:not([data-turbo=true]) input[type=image], form:not([data-turbo=true]) button[type=submit], form:not([data-turbo=true]) button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]), textarea[name][required]:not([disabled])",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",csrfToken:function(){return e("meta[name=csrf-token]").attr("content")},csrfParam:function(){return e("meta[name=csrf-param]").attr("content")},CSRFProtection:function(e){var t=n.csrfToken();t&&e.setRequestHeader("X-CSRF-Token",t)},refreshCSRFTokens:function(){e('form input[name="'+n.csrfParam()+'"]').val(n.csrfToken())},fire:function(t,n,i){var a=e.Event(n);return t.trigger(a,i),!1!==a.result},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e[0].href},isRemote:function(e){return e.data("remote")!==t&&!1!==e.data("remote")},handleRemote:function(i){var a,r,o,s,l,d;if(n.fire(i,"ajax:before")){if(s=i.data("with-credentials")||null,l=i.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,i.is("form")){a=i.data("ujs:submit-button-formmethod")||i.attr("method"),r=i.data("ujs:submit-button-formaction")||i.attr("action"),o=e(i[0]).serializeArray();var u=i.data("ujs:submit-button");u&&(o.push(u),i.data("ujs:submit-button",null)),i.data("ujs:submit-button-formmethod",null),i.data("ujs:submit-button-formaction",null)}else i.is(n.inputChangeSelector)?(a=i.data("method"),r=i.data("url"),o=i.serialize(),i.data("params")&&(o=o+"&"+i.data("params"))):i.is(n.buttonClickSelector)?(a=i.data("method")||"get",r=i.data("url"),o=i.serialize(),i.data("params")&&(o=o+"&"+i.data("params"))):(a=i.data("method"),r=n.href(i),o=i.data("params")||null);return d={type:a||"GET",data:o,dataType:l,beforeSend:function(e,a){if(a.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+a.accepts.script),!n.fire(i,"ajax:beforeSend",[e,a]))return!1;i.trigger("ajax:send",e)},success:function(e,t,n){i.trigger("ajax:success",[e,t,n])},complete:function(e,t){i.trigger("ajax:complete",[e,t])},error:function(e,t,n){i.trigger("ajax:error",[e,t,n])},crossDomain:n.isCrossDomain(r)},s&&(d.xhrFields={withCredentials:s}),r&&(d.url=r),n.ajax(d)}return!1},isCrossDomain:function(e){var t=document.createElement("a");t.href=location.href;var n=document.createElement("a");try{return n.href=e,n.href=n.href,!((!n.protocol||":"===n.protocol)&&!n.host||t.protocol+"//"+t.host==n.protocol+"//"+n.host)}catch(i){return!0}},handleMethod:function(i){var a=n.href(i),r=i.data("method"),o=i.attr("target"),s=n.csrfToken(),l=n.csrfParam(),d=e('<form method="post" action="'+a+'"></form>'),u='<input name="_method" value="'+r+'" type="hidden" />';l===t||s===t||n.isCrossDomain(a)||(u+='<input name="'+l+'" value="'+s+'" type="hidden" />'),o&&d.attr("target",o),d.hide().append(u).appendTo("body"),d.submit()},formElements:function(t,n){return t.is("form")?e(t[0].elements).filter(n):t.find(n)},disableFormElements:function(t){n.formElements(t,n.disableSelector).each(function(){n.disableFormElement(e(this))})},disableFormElement:function(e){var n,i;n=e.is("button")?"html":"val",(i=e.data("disable-with"))!==t&&(e.data("ujs:enable-with",e[n]()),e[n](i)),e.prop("disabled",!0),e.data("ujs:disabled",!0)},enableFormElements:function(t){n.formElements(t,n.enableSelector).each(function(){n.enableFormElement(e(this))})},enableFormElement:function(e){var n=e.is("button")?"html":"val";e.data("ujs:enable-with")!==t&&(e[n](e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.prop("disabled",!1),e.removeData("ujs:disabled")},allowAction:function(e){var t,i=e.data("confirm"),a=!1;if(!i)return!0;if(n.fire(e,"confirm")){try{a=n.confirm(i)}catch(r){(console.error||console.log).call(console,r.stack||r)}t=n.fire(e,"confirm:complete",[a])}return a&&t},blankInputs:function(t,n,i){var a,r,o,s=e(),l=n||"input,textarea",d=t.find(l),u={};return d.each(function(){(a=e(this)).is("input[type=radio]")?(o=a.attr("name"),u[o]||(0===t.find('input[type=radio]:checked[name="'+o+'"]').length&&(r=t.find('input[type=radio][name="'+o+'"]'),s=s.add(r)),u[o]=o)):(a.is("input[type=checkbox],input[type=radio]")?a.is(":checked"):!!a.val())===i&&(s=s.add(a))}),!!s.length&&s},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){var i=e.data("disable-with");i!==t&&(e.data("ujs:enable-with",e.html()),e.html(i)),e.on("click.railsDisable",function(e){return n.stopEverything(e)}),e.data("ujs:disabled",!0)},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.off("click.railsDisable"),e.removeData("ujs:disabled")}},n.fire(i,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,i){e.crossDomain||n.CSRFProtection(i)}),e(window).on("pageshow.rails",function(){e(e.rails.enableSelector).each(function(){var t=e(this);t.data("ujs:disabled")&&e.rails.enableFormElement(t)}),e(e.rails.linkDisableSelector).each(function(){var t=e(this);t.data("ujs:disabled")&&e.rails.enableElement(t)})}),i.on("ajax:complete",n.linkDisableSelector,function(){n.enableElement(e(this))}),i.on("ajax:complete",n.buttonDisableSelector,function(){n.enableFormElement(e(this))}),i.on("click.rails",n.linkClickSelector,function(t){var i=e(this),a=i.data("method"),r=i.data("params"),o=t.metaKey||t.ctrlKey;if(!n.allowAction(i))return n.stopEverything(t);if(!o&&i.is(n.linkDisableSelector)&&n.disableElement(i),n.isRemote(i)){if(o&&(!a||"GET"===a)&&!r)return!0;var s=n.handleRemote(i);return!1===s?n.enableElement(i):s.fail(function(){n.enableElement(i)}),!1}return a?(n.handleMethod(i),!1):void 0}),i.on("click.rails",n.buttonClickSelector,function(t){var i=e(this);if(!n.allowAction(i)||!n.isRemote(i))return n.stopEverything(t);i.is(n.buttonDisableSelector)&&n.disableFormElement(i);var a=n.handleRemote(i);return!1===a?n.enableFormElement(i):a.fail(function(){n.enableFormElement(i)}),!1}),i.on("change.rails",n.inputChangeSelector,function(t){var i=e(this);return n.allowAction(i)&&n.isRemote(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),i.on("submit.rails",n.formSubmitSelector,function(i){var a,r,o=e(this),s=n.isRemote(o);if(!n.allowAction(o))return n.stopEverything(i);if(o.attr("novalidate")===t)if(o.data("ujs:formnovalidate-button")===t){if((a=n.blankInputs(o,n.requiredInputSelector,!1))&&n.fire(o,"ajax:aborted:required",[a]))return n.stopEverything(i)}else o.data("ujs:formnovalidate-button",t);if(s){if(r=n.nonBlankInputs(o,n.fileInputSelector)){setTimeout(function(){n.disableFormElements(o)},13);var l=n.fire(o,"ajax:aborted:file",[r]);return l||setTimeout(function(){n.enableFormElements(o)},13),l}return n.handleRemote(o),!1}setTimeout(function(){n.disableFormElements(o)},13)}),i.on("click.rails",n.formInputClickSelector,function(t){var i=e(this);if(!n.allowAction(i))return n.stopEverything(t);var a=i.attr("name"),r=a?{name:a,value:i.val()}:null,o=i.closest("form");0===o.length&&(o=e("#"+i.attr("form"))),o.data("ujs:submit-button",r),o.data("ujs:formnovalidate-button",i.attr("formnovalidate")),o.data("ujs:submit-button-formaction",i.attr("formaction")),o.data("ujs:submit-button-formmethod",i.attr("formmethod"))}),i.on("ajax:send.rails",n.formSubmitSelector,function(t){this===t.target&&n.disableFormElements(e(this))}),i.on("ajax:complete.rails",n.formSubmitSelector,function(t){this===t.target&&n.enableFormElements(e(this))}),e(function(){n.refreshCSRFTokens()}))};window.jQuery?e(jQuery):"object"==typeof exports&&"object"==typeof module&&(module.exports=e)}();const tooltipTriggerList=document.querySelectorAll('[data-bs-toggle="tooltip"]'),tooltipList=[...tooltipTriggerList].map(e=>new bootstrap.Tooltip(e));var ThingSpeak=ThingSpeak||{};ThingSpeak.showConfirmModal=function(e,t){const n=e.attr("data-confirm"),i=e.attr("data-confirm-title");$("#confirmation-modal .modal-body").text(n),i&&$("#confirmation-modal .modal-title").text(i),$("#confirmation-modal").on("hidden.bs.modal",()=>{$("#confirmation-modal-ok").off("click")}),$("#confirmation-modal-ok").one("click",()=>{t(e)}),new bootstrap.Modal(document.getElementById("confirmation-modal")).show()},function(e){const t=function(e){const t=e.attr("data-confirm");e.removeAttr("data-confirm"),e.is("form")?e.trigger("submit.rails"):e.trigger("click.rails"),e.attr("data-confirm",t)};e.allowAction=function(e){return!e.attr("data-confirm")||(ThingSpeak.showConfirmModal(e,t),!1)}}($.rails),
/*!
 * jQuery Cookie Plugin
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
function(e){e.cookie=function(t,n,i){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null===n||n===undefined)){if(i=e.extend({},i),null!==n&&n!==undefined||(i.expires=-1),"number"==typeof i.expires){var a=i.expires,r=i.expires=new Date;r.setDate(r.getDate()+a)}return n=String(n),document.cookie=[encodeURIComponent(t),"=",i.raw?n:encodeURIComponent(n),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var o,s=(i=n||{}).raw?function(e){return e}:decodeURIComponent,l=document.cookie.split("; "),d=0;o=l[d]&&l[d].split("=");d++)if(s(o[0])===t)return s(o[1]||"");return null}}(jQuery),
/*
Turbolinks 5.2.0
Copyright © 2018 Basecamp, LLC
 */
function(){var e=this;(function(){(function(){this.Turbolinks={supported:null!=window.history.pushState&&null!=window.requestAnimationFrame&&null!=window.addEventListener,visit:function(e,n){return t.controller.visit(e,n)},clearCache:function(){return t.controller.clearCache()},setProgressBarDelay:function(e){return t.controller.setProgressBarDelay(e)}}}).call(this)}).call(e);var t=e.Turbolinks;(function(){(function(){var e,n,i,a=[].slice;t.copyObject=function(e){var t,n,i;for(t in n={},e)i=e[t],n[t]=i;return n},t.closest=function(t,n){return e.call(t,n)},e=function(){var e;return null!=(e=document.documentElement.closest)?e:function(e){var t;for(t=this;t;){if(t.nodeType===Node.ELEMENT_NODE&&n.call(t,e))return t;t=t.parentNode}}}(),t.defer=function(e){return setTimeout(e,1)},t.throttle=function(e){var t;return t=null,function(){var n,i;return n=1<=arguments.length?a.call(arguments,0):[],null!=t?t:t=requestAnimationFrame((i=this,function(){return t=null,e.apply(i,n)}))}},t.dispatch=function(e,t){var n,a,r,o,s,l;return l=(s=null!=t?t:{}).target,n=s.cancelable,a=s.data,(r=document.createEvent("Events")).initEvent(e,!0,!0===n),r.data=null!=a?a:{},r.cancelable&&!i&&(o=r.preventDefault,r.preventDefault=function(){return this.defaultPrevented||Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}}),o.call(this)}),(null!=l?l:document).dispatchEvent(r),r},i=function(){var e;return(e=document.createEvent("Events")).initEvent("test",!0,!0),e.preventDefault(),e.defaultPrevented}(),t.match=function(e,t){return n.call(e,t)},n=function(){var e,t,n,i;return null!=(t=null!=(n=null!=(i=(e=document.documentElement).matchesSelector)?i:e.webkitMatchesSelector)?n:e.msMatchesSelector)?t:e.mozMatchesSelector}(),t.uuid=function(){var e,t,n;for(n="",e=t=1;36>=t;e=++t)n+=9===e||14===e||19===e||24===e?"-":15===e?"4":20===e?(Math.floor(4*Math.random())+8).toString(16):Math.floor(15*Math.random()).toString(16);return n}}).call(this),function(){t.Location=function(){function e(e){var t,n;null==e&&(e=""),(n=document.createElement("a")).href=e.toString(),this.absoluteURL=n.href,2>(t=n.hash.length)?this.requestURL=this.absoluteURL:(this.requestURL=this.absoluteURL.slice(0,-t),this.anchor=n.hash.slice(1))}var t,n,i,a;return e.wrap=function(e){return e instanceof this?e:new this(e)},e.prototype.getOrigin=function(){return this.absoluteURL.split("/",3).join("/")},e.prototype.getPath=function(){var e,t;return null!=(e=null!=(t=this.requestURL.match(/\/\/[^\/]*(\/[^?;]*)/))?t[1]:void 0)?e:"/"},e.prototype.getPathComponents=function(){return this.getPath().split("/").slice(1)},e.prototype.getLastPathComponent=function(){return this.getPathComponents().slice(-1)[0]},e.prototype.getExtension=function(){var e,t;return null!=(e=null!=(t=this.getLastPathComponent().match(/\.[^.]*$/))?t[0]:void 0)?e:""},e.prototype.isHTML=function(){return this.getExtension().match(/^(?:|\.(?:htm|html|xhtml))$/)},e.prototype.isPrefixedBy=function(e){var t;return t=n(e),this.isEqualTo(e)||a(this.absoluteURL,t)},e.prototype.isEqualTo=function(e){return this.absoluteURL===(null!=e?e.absoluteURL:void 0)},e.prototype.toCacheKey=function(){return this.requestURL},e.prototype.toJSON=function(){return this.absoluteURL},e.prototype.toString=function(){return this.absoluteURL},e.prototype.valueOf=function(){return this.absoluteURL},n=function(e){return t(e.getOrigin()+e.getPath())},t=function(e){return i(e,"/")?e:e+"/"},a=function(e,t){return e.slice(0,t.length)===t},i=function(e,t){return e.slice(-t.length)===t},e}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};t.HttpRequest=function(){function n(n,i,a){this.delegate=n,this.requestCanceled=e(this.requestCanceled,this),this.requestTimedOut=e(this.requestTimedOut,this),this.requestFailed=e(this.requestFailed,this),this.requestLoaded=e(this.requestLoaded,this),this.requestProgressed=e(this.requestProgressed,this),this.url=t.Location.wrap(i).requestURL,this.referrer=t.Location.wrap(a).absoluteURL,this.createXHR()}return n.NETWORK_FAILURE=0,n.TIMEOUT_FAILURE=-1,n.timeout=60,n.prototype.send=function(){var e;return this.xhr&&!this.sent?(this.notifyApplicationBeforeRequestStart(),this.setProgress(0),this.xhr.send(),this.sent=!0,"function"==typeof(e=this.delegate).requestStarted?e.requestStarted():void 0):void 0},n.prototype.cancel=function(){return this.xhr&&this.sent?this.xhr.abort():void 0},n.prototype.requestProgressed=function(e){return e.lengthComputable?this.setProgress(e.loaded/e.total):void 0},n.prototype.requestLoaded=function(){return this.endRequest((e=this,function(){var t;return 200<=(t=e.xhr.status)&&300>t?e.delegate.requestCompletedWithResponse(e.xhr.responseText,e.xhr.getResponseHeader("Turbolinks-Location")):(e.failed=!0,e.delegate.requestFailedWithStatusCode(e.xhr.status,e.xhr.responseText))}));var e},n.prototype.requestFailed=function(){return this.endRequest((e=this,function(){return e.failed=!0,e.delegate.requestFailedWithStatusCode(e.constructor.NETWORK_FAILURE)}));var e},n.prototype.requestTimedOut=function(){return this.endRequest((e=this,function(){return e.failed=!0,e.delegate.requestFailedWithStatusCode(e.constructor.TIMEOUT_FAILURE)}));var e},n.prototype.requestCanceled=function(){return this.endRequest()},n.prototype.notifyApplicationBeforeRequestStart=function(){return t.dispatch("turbolinks:request-start",{data:{url:this.url,xhr:this.xhr}})},n.prototype.notifyApplicationAfterRequestEnd=function(){return t.dispatch("turbolinks:request-end",{data:{url:this.url,xhr:this.xhr}})},n.prototype.createXHR=function(){return this.xhr=new XMLHttpRequest,this.xhr.open("GET",this.url,!0),this.xhr.timeout=1e3*this.constructor.timeout,this.xhr.setRequestHeader("Accept","text/html, application/xhtml+xml"),this.xhr.setRequestHeader("Turbolinks-Referrer",this.referrer),this.xhr.onprogress=this.requestProgressed,this.xhr.onload=this.requestLoaded,this.xhr.onerror=this.requestFailed,this.xhr.ontimeout=this.requestTimedOut,this.xhr.onabort=this.requestCanceled},n.prototype.endRequest=function(e){return this.xhr?(this.notifyApplicationAfterRequestEnd(),null!=e&&e.call(this),this.destroy()):void 0},n.prototype.setProgress=function(e){var t;return this.progress=e,"function"==typeof(t=this.delegate).requestProgressed?t.requestProgressed(this.progress):void 0},n.prototype.destroy=function(){var e;return this.setProgress(1),"function"==typeof(e=this.delegate).requestFinished&&e.requestFinished(),this.delegate=null,this.xhr=null},n}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};t.ProgressBar=function(){function t(){this.trickle=e(this.trickle,this),this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement()}var n;return n=300,t.defaultCSS=".turbolinks-progress-bar {\n  position: fixed;\n  display: block;\n  top: 0;\n  left: 0;\n  height: 3px;\n  background: #0076ff;\n  z-index: 9999;\n  transition: width "+n+"ms ease-out, opacity "+n/2+"ms "+n/2+"ms ease-in;\n  transform: translate3d(0, 0, 0);\n}",t.prototype.show=function(){return this.visible?void 0:(this.visible=!0,this.installStylesheetElement(),this.installProgressElement(),this.startTrickling())},t.prototype.hide=function(){return this.visible&&!this.hiding?(this.hiding=!0,this.fadeProgressElement((e=this,function(){return e.uninstallProgressElement(),e.stopTrickling(),e.visible=!1,e.hiding=!1}))):void 0;var e},t.prototype.setValue=function(e){return this.value=e,this.refresh()},t.prototype.installStylesheetElement=function(){return document.head.insertBefore(this.stylesheetElement,document.head.firstChild)},t.prototype.installProgressElement=function(){return this.progressElement.style.width=0,this.progressElement.style.opacity=1,document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()},t.prototype.fadeProgressElement=function(e){return this.progressElement.style.opacity=0,setTimeout(e,1.5*n)},t.prototype.uninstallProgressElement=function(){return this.progressElement.parentNode?document.documentElement.removeChild(this.progressElement):void 0},t.prototype.startTrickling=function(){return null!=this.trickleInterval?this.trickleInterval:this.trickleInterval=setInterval(this.trickle,n)},t.prototype.stopTrickling=function(){return clearInterval(this.trickleInterval),this.trickleInterval=null},t.prototype.trickle=function(){return this.setValue(this.value+Math.random()/100)},t.prototype.refresh=function(){return requestAnimationFrame((e=this,function(){return e.progressElement.style.width=10+90*e.value+"%"}));var e},t.prototype.createStylesheetElement=function(){var e;return(e=document.createElement("style")).type="text/css",e.textContent=this.constructor.defaultCSS,e},t.prototype.createProgressElement=function(){var e;return(e=document.createElement("div")).className="turbolinks-progress-bar",e},t}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};t.BrowserAdapter=function(){function n(n){this.controller=n,this.showProgressBar=e(this.showProgressBar,this),this.progressBar=new t.ProgressBar}var i,a,r;return r=t.HttpRequest,i=r.NETWORK_FAILURE,a=r.TIMEOUT_FAILURE,n.prototype.visitProposedToLocationWithAction=function(e,t){return this.controller.startVisitToLocationWithAction(e,t)},n.prototype.visitStarted=function(e){return e.issueRequest(),e.changeHistory(),e.loadCachedSnapshot()},n.prototype.visitRequestStarted=function(e){return this.progressBar.setValue(0),e.hasCachedSnapshot()||"restore"!==e.action?this.showProgressBarAfterDelay():this.showProgressBar()},n.prototype.visitRequestProgressed=function(e){return this.progressBar.setValue(e.progress)},n.prototype.visitRequestCompleted=function(e){return e.loadResponse()},n.prototype.visitRequestFailedWithStatusCode=function(e,t){switch(t){case i:case a:return this.reload();default:return e.loadResponse()}},n.prototype.visitRequestFinished=function(){return this.hideProgressBar()},n.prototype.visitCompleted=function(e){return e.followRedirect()},n.prototype.pageInvalidated=function(){return this.reload()},n.prototype.showProgressBarAfterDelay=function(){return this.progressBarTimeout=setTimeout(this.showProgressBar,this.controller.progressBarDelay)},n.prototype.showProgressBar=function(){return this.progressBar.show()},n.prototype.hideProgressBar=function(){return this.progressBar.hide(),clearTimeout(this.progressBarTimeout)},n.prototype.reload=function(){return window.location.reload()},n}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};t.History=function(){function n(t){this.delegate=t,this.onPageLoad=e(this.onPageLoad,this),this.onPopState=e(this.onPopState,this)}return n.prototype.start=function(){return this.started?void 0:(addEventListener("popstate",this.onPopState,!1),addEventListener("load",this.onPageLoad,!1),this.started=!0)},n.prototype.stop=function(){return this.started?(removeEventListener("popstate",this.onPopState,!1),removeEventListener("load",this.onPageLoad,!1),this.started=!1):void 0},n.prototype.push=function(e,n){return e=t.Location.wrap(e),this.update("push",e,n)},n.prototype.replace=function(e,n){return e=t.Location.wrap(e),this.update("replace",e,n)},n.prototype.onPopState=function(e){var n,i,a,r;return this.shouldHandlePopState()&&(r=null!=(i=e.state)?i.turbolinks:void 0)?(n=t.Location.wrap(window.location),a=r.restorationIdentifier,this.delegate.historyPoppedToLocationWithRestorationIdentifier(n,a)):void 0},n.prototype.onPageLoad=function(){return t.defer(function(e){return function(){return e.pageLoaded=!0}}(this))},n.prototype.shouldHandlePopState=function(){return this.pageIsLoaded()},n.prototype.pageIsLoaded=function(){return this.pageLoaded||"complete"===document.readyState},n.prototype.update=function(e,t,n){var i;return i={turbolinks:{restorationIdentifier:n}},history[e+"State"](i,null,t)},n}()}.call(this),function(){t.HeadDetails=function(){function e(e){var t,n,i,o,s;for(this.elements={},n=0,o=e.length;o>n;n++)(s=e[n]).nodeType===Node.ELEMENT_NODE&&(i=s.outerHTML,(null!=(t=this.elements)[i]?t[i]:t[i]={type:r(s),tracked:a(s),elements:[]}).elements.push(s))}var t,n,i,a,r;return e.fromHeadElement=function(e){var t;return new this(null!=(t=null!=e?e.childNodes:void 0)?t:[])},e.prototype.hasElementWithKey=function(e){return e in this.elements},e.prototype.getTrackedElementSignature=function(){var e;return function(){var t,n;for(e in n=[],t=this.elements)t[e].tracked&&n.push(e);return n}.call(this).join("")},e.prototype.getScriptElementsNotInDetails=function(e){return this.getElementsMatchingTypeNotInDetails("script",e)},e.prototype.getStylesheetElementsNotInDetails=function(e){return this.getElementsMatchingTypeNotInDetails("stylesheet",e)},e.prototype.getElementsMatchingTypeNotInDetails=function(e,t){var n,i,a,r,o,s;for(i in o=[],a=this.elements)s=(r=a[i]).type,n=r.elements,s!==e||t.hasElementWithKey(i)||o.push(n[0]);return o},e.prototype.getProvisionalElements=function(){var e,t,n,i,a,r,o;for(t in n=[],i=this.elements)o=(a=i[t]).type,r=a.tracked,e=a.elements,null!=o||r?e.length>1&&n.push.apply(n,e.slice(1)):n.push.apply(n,e);return n},e.prototype.getMetaValue=function(e){var t;return null!=(t=this.findMetaElementByName(e))?t.getAttribute("content"):void 0},e.prototype.findMetaElementByName=function(e){var n,i,a,r;for(a in n=void 0,r=this.elements)i=r[a].elements,t(i[0],e)&&(n=i[0]);return n},r=function(e){return n(e)?"script":i(e)?"stylesheet":void 0},a=function(e){return"reload"===e.getAttribute("data-turbolinks-track")},n=function(e){return"script"===e.tagName.toLowerCase()},i=function(e){var t;return"style"===(t=e.tagName.toLowerCase())||"link"===t&&"stylesheet"===e.getAttribute("rel")},t=function(e,t){return"meta"===e.tagName.toLowerCase()&&e.getAttribute("name")===t},e}()}.call(this),function(){t.Snapshot=function(){function e(e,t){this.headDetails=e,this.bodyElement=t}return e.wrap=function(e){return e instanceof this?e:"string"==typeof e?this.fromHTMLString(e):this.fromHTMLElement(e)},e.fromHTMLString=function(e){var t;return(t=document.createElement("html")).innerHTML=e,this.fromHTMLElement(t)},e.fromHTMLElement=function(e){var n,i,a;return i=e.querySelector("head"),n=null!=(a=e.querySelector("body"))?a:document.createElement("body"),new this(t.HeadDetails.fromHeadElement(i),n)},e.prototype.clone=function(){return new this.constructor(this.headDetails,this.bodyElement.cloneNode(!0))},e.prototype.getRootLocation=function(){var e,n;return n=null!=(e=this.getSetting("root"))?e:"/",new t.Location(n)},e.prototype.getCacheControlValue=function(){return this.getSetting("cache-control")},e.prototype.getElementForAnchor=function(e){try{return this.bodyElement.querySelector("[id='"+e+"'], a[name='"+e+"']")}catch(t){}},e.prototype.getPermanentElements=function(){return this.bodyElement.querySelectorAll("[id][data-turbolinks-permanent]")},e.prototype.getPermanentElementById=function(e){return this.bodyElement.querySelector("#"+e+"[data-turbolinks-permanent]")},e.prototype.getPermanentElementsPresentInSnapshot=function(e){var t,n,i,a,r;for(r=[],n=0,i=(a=this.getPermanentElements()).length;i>n;n++)t=a[n],e.getPermanentElementById(t.id)&&r.push(t);return r},e.prototype.findFirstAutofocusableElement=function(){return this.bodyElement.querySelector("[autofocus]")},e.prototype.hasAnchor=function(e){return null!=this.getElementForAnchor(e)},e.prototype.isPreviewable=function(){return"no-preview"!==this.getCacheControlValue()},e.prototype.isCacheable=function(){return"no-cache"!==this.getCacheControlValue()},e.prototype.isVisitable=function(){return"reload"!==this.getSetting("visit-control")},e.prototype.getSetting=function(e){return this.headDetails.getMetaValue("turbolinks-"+e)},e}()}.call(this),function(){var e=[].slice;t.Renderer=function(){function t(){}var n;return t.render=function(){var t,n,i;return n=arguments[0],t=arguments[1],(i=function(e,t,n){n.prototype=e.prototype;var i=new n,a=e.apply(i,t);return Object(a)===a?a:i}(this,3<=arguments.length?e.call(arguments,2):[],function(){})).delegate=n,i.render(t),i},t.prototype.renderView=function(e){return this.delegate.viewWillRender(this.newBody),e(),this.delegate.viewRendered(this.newBody)},t.prototype.invalidateView=function(){return this.delegate.viewInvalidated()},t.prototype.createScriptElement=function(e){var t;return"false"===e.getAttribute("data-turbolinks-eval")?e:((t=document.createElement("script")).textContent=e.textContent,t.async=!1,n(t,e),t)},n=function(e,t){var n,i,a,r,o,s,l;for(s=[],n=0,i=(r=t.attributes).length;i>n;n++)a=(o=r[n]).name,l=o.value,s.push(e.setAttribute(a,l));return s},t}()}.call(this),function(){var e,n,i=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},a={}.hasOwnProperty;t.SnapshotRenderer=function(t){function a(e,t,n){this.currentSnapshot=e,this.newSnapshot=t,this.isPreview=n,this.currentHeadDetails=this.currentSnapshot.headDetails,this.newHeadDetails=this.newSnapshot.headDetails,this.currentBody=this.currentSnapshot.bodyElement,this.newBody=this.newSnapshot.bodyElement}return i(a,t),a.prototype.render=function(e){return this.shouldRender()?(this.mergeHead(),this.renderView((t=this,function(){return t.replaceBody(),t.isPreview||t.focusFirstAutofocusableElement(),e()}))):this.invalidateView();var t},a.prototype.mergeHead=function(){return this.copyNewHeadStylesheetElements(),this.copyNewHeadScriptElements(),this.removeCurrentHeadProvisionalElements(),this.copyNewHeadProvisionalElements()},a.prototype.replaceBody=function(){var e;return e=this.relocateCurrentBodyPermanentElements(),this.activateNewBodyScriptElements(),this.assignNewBody(),this.replacePlaceholderElementsWithClonedPermanentElements(e)},a.prototype.shouldRender=function(){return this.newSnapshot.isVisitable()&&this.trackedElementsAreIdentical()},a.prototype.trackedElementsAreIdentical=function(){return this.currentHeadDetails.getTrackedElementSignature()===this.newHeadDetails.getTrackedElementSignature()},a.prototype.copyNewHeadStylesheetElements=function(){var e,t,n,i,a;for(a=[],t=0,n=(i=this.getNewHeadStylesheetElements()).length;n>t;t++)e=i[t],a.push(document.head.appendChild(e));return a},a.prototype.copyNewHeadScriptElements=function(){var e,t,n,i,a;for(a=[],t=0,n=(i=this.getNewHeadScriptElements()).length;n>t;t++)e=i[t],a.push(document.head.appendChild(this.createScriptElement(e)));return a},a.prototype.removeCurrentHeadProvisionalElements=function(){var e,t,n,i,a;for(a=[],t=0,n=(i=this.getCurrentHeadProvisionalElements()).length;n>t;t++)e=i[t],a.push(document.head.removeChild(e));return a},a.prototype.copyNewHeadProvisionalElements=function(){var e,t,n,i,a;for(a=[],t=0,n=(i=this.getNewHeadProvisionalElements()).length;n>t;t++)e=i[t],a.push(document.head.appendChild(e));return a},a.prototype.relocateCurrentBodyPermanentElements=function(){var t,i,a,r,o,s,l;for(l=[],t=0,i=(s=this.getCurrentBodyPermanentElements()).length;i>t;t++)r=s[t],o=e(r),a=this.newSnapshot.getPermanentElementById(r.id),n(r,o.element),n(a,r),l.push(o);return l},a.prototype.replacePlaceholderElementsWithClonedPermanentElements=function(e){var t,i,a,r,o,s;for(s=[],a=0,r=e.length;r>a;a++)i=(o=e[a]).element,t=o.permanentElement.cloneNode(!0),s.push(n(i,t));return s},a.prototype.activateNewBodyScriptElements=function(){var e,t,i,a,r,o;for(o=[],t=0,a=(r=this.getNewBodyScriptElements()).length;a>t;t++)i=r[t],e=this.createScriptElement(i),o.push(n(i,e));return o},a.prototype.assignNewBody=function(){return document.body=this.newBody},a.prototype.focusFirstAutofocusableElement=function(){var e;return null!=(e=this.newSnapshot.findFirstAutofocusableElement())?e.focus():void 0},a.prototype.getNewHeadStylesheetElements=function(){return this.newHeadDetails.getStylesheetElementsNotInDetails(this.currentHeadDetails)},a.prototype.getNewHeadScriptElements=function(){return this.newHeadDetails.getScriptElementsNotInDetails(this.currentHeadDetails)},a.prototype.getCurrentHeadProvisionalElements=function(){return this.currentHeadDetails.getProvisionalElements()},a.prototype.getNewHeadProvisionalElements=function(){return this.newHeadDetails.getProvisionalElements()},a.prototype.getCurrentBodyPermanentElements=function(){return this.currentSnapshot.getPermanentElementsPresentInSnapshot(this.newSnapshot)},a.prototype.getNewBodyScriptElements=function(){return this.newBody.querySelectorAll("script")},a}(t.Renderer),e=function(e){var t;return(t=document.createElement("meta")).setAttribute("name","turbolinks-permanent-placeholder"),t.setAttribute("content",e.id),{element:t,permanentElement:e}},n=function(e,t){var n;return(n=e.parentNode)?n.replaceChild(t,e):void 0}}.call(this),function(){var e=function(e,t){function i(){this.constructor=e}for(var a in t)n.call(t,a)&&(e[a]=t[a]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;t.ErrorRenderer=function(t){function n(e){var t;(t=document.createElement("html")).innerHTML=e,this.newHead=t.querySelector("head"),this.newBody=t.querySelector("body")}return e(n,t),n.prototype.render=function(e){return this.renderView((t=this,function(){return t.replaceHeadAndBody(),t.activateBodyScriptElements(),e()}));var t},n.prototype.replaceHeadAndBody=function(){var e,t;return t=document.head,e=document.body,t.parentNode.replaceChild(this.newHead,t),e.parentNode.replaceChild(this.newBody,e)},n.prototype.activateBodyScriptElements=function(){var e,t,n,i,a,r;for(r=[],t=0,n=(i=this.getScriptElements()).length;n>t;t++)a=i[t],e=this.createScriptElement(a),r.push(a.parentNode.replaceChild(e,a));return r},n.prototype.getScriptElements=function(){return document.documentElement.querySelectorAll("script")},n}(t.Renderer)}.call(this),function(){t.View=function(){function e(e){this.delegate=e,this.htmlElement=document.documentElement}return e.prototype.getRootLocation=function(){return this.getSnapshot().getRootLocation()},e.prototype.getElementForAnchor=function(e){return this.getSnapshot().getElementForAnchor(e)},e.prototype.getSnapshot=function(){return t.Snapshot.fromHTMLElement(this.htmlElement)},e.prototype.render=function(e,t){var n,i,a;return a=e.snapshot,n=e.error,i=e.isPreview,this.markAsPreview(i),null!=a?this.renderSnapshot(a,i,t):this.renderError(n,t)},e.prototype.markAsPreview=function(e){return e?this.htmlElement.setAttribute("data-turbolinks-preview",""):this.htmlElement.removeAttribute("data-turbolinks-preview")},e.prototype.renderSnapshot=function(e,n,i){return t.SnapshotRenderer.render(this.delegate,i,this.getSnapshot(),t.Snapshot.wrap(e),n)},e.prototype.renderError=function(e,n){return t.ErrorRenderer.render(this.delegate,n,e)},e}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};t.ScrollManager=function(){function n(n){this.delegate=n,this.onScroll=e(this.onScroll,this),this.onScroll=t.throttle(this.onScroll)}return n.prototype.start=function(){return this.started?void 0:(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)},n.prototype.stop=function(){return this.started?(removeEventListener("scroll",this.onScroll,!1),this.started=!1):void 0},n.prototype.scrollToElement=function(e){return e.scrollIntoView()},n.prototype.scrollToPosition=function(e){var t,n;return t=e.x,n=e.y,window.scrollTo(t,n)},n.prototype.onScroll=function(){return this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})},n.prototype.updatePosition=function(e){var t;return this.position=e,null!=(t=this.delegate)?t.scrollPositionChanged(this.position):void 0},n}()}.call(this),function(){t.SnapshotCache=function(){function e(e){this.size=e,this.keys=[],this.snapshots={}}var n;return e.prototype.has=function(e){return n(e)in this.snapshots},e.prototype.get=function(e){var t;if(this.has(e))return t=this.read(e),this.touch(e),t},e.prototype.put=function(e,t){return this.write(e,t),this.touch(e),t},e.prototype.read=function(e){var t;return t=n(e),this.snapshots[t]},e.prototype.write=function(e,t){var i;return i=n(e),this.snapshots[i]=t},e.prototype.touch=function(e){var t,i;return i=n(e),(t=this.keys.indexOf(i))>-1&&this.keys.splice(t,1),this.keys.unshift(i),this.trim()},e.prototype.trim=function(){var e,t,n,i,a;for(a=[],e=0,n=(i=this.keys.splice(this.size)).length;n>e;e++)t=i[e],a.push(delete this.snapshots[t]);return a},n=function(e){return t.Location.wrap(e).toCacheKey()},e}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};t.Visit=function(){function n(n,i,a){this.controller=n,this.action=a,this.performScroll=e(this.performScroll,this),this.identifier=t.uuid(),this.location=t.Location.wrap(i),this.adapter=this.controller.adapter,this.state="initialized",this.timingMetrics={}}var i;return n.prototype.start=function(){return"initialized"===this.state?(this.recordTimingMetric("visitStart"),this.state="started",this.adapter.visitStarted(this)):void 0},n.prototype.cancel=function(){var e;return"started"===this.state?(null!=(e=this.request)&&e.cancel(),this.cancelRender(),this.state="canceled"):void 0},n.prototype.complete=function(){var e;return"started"===this.state?(this.recordTimingMetric("visitEnd"),this.state="completed","function"==typeof(e=this.adapter).visitCompleted&&e.visitCompleted(this),this.controller.visitCompleted(this)):void 0},n.prototype.fail=function(){var e;return"started"===this.state?(this.state="failed","function"==typeof(e=this.adapter).visitFailed?e.visitFailed(this):void 0):void 0},n.prototype.changeHistory=function(){var e,t;return this.historyChanged?void 0:(e=this.location.isEqualTo(this.referrer)?"replace":this.action,t=i(e),this.controller[t](this.location,this.restorationIdentifier),this.historyChanged=!0)},n.prototype.issueRequest=function(){return this.shouldIssueRequest()&&null==this.request?(this.progress=0,this.request=new t.HttpRequest(this,this.location,this.referrer),this.request.send()):void 0},n.prototype.getCachedSnapshot=function(){var e;return!(e=this.controller.getCachedSnapshotForLocation(this.location))||null!=this.location.anchor&&!e.hasAnchor(this.location.anchor)||"restore"!==this.action&&!e.isPreviewable()?void 0:e},n.prototype.hasCachedSnapshot=function(){return null!=this.getCachedSnapshot()},n.prototype.loadCachedSnapshot=function(){var e,t;return(t=this.getCachedSnapshot())?(e=this.shouldIssueRequest(),this.render(function(){var n;return this.cacheSnapshot(),this.controller.render({snapshot:t,isPreview:e},this.performScroll),"function"==typeof(n=this.adapter).visitRendered&&n.visitRendered(this),e?void 0:this.complete()})):void 0},n.prototype.loadResponse=function(){return null!=this.response?this.render(function(){var e,t;return this.cacheSnapshot(),this.request.failed?(this.controller.render({error:this.response},this.performScroll),"function"==typeof(e=this.adapter).visitRendered&&e.visitRendered(this),this.fail()):(this.controller.render({snapshot:this.response},this.performScroll),"function"==typeof(t=this.adapter).visitRendered&&t.visitRendered(this),this.complete())}):void 0},n.prototype.followRedirect=function(){return this.redirectedToLocation&&!this.followedRedirect?(this.location=this.redirectedToLocation,this.controller.replaceHistoryWithLocationAndRestorationIdentifier(this.redirectedToLocation,this.restorationIdentifier),this.followedRedirect=!0):void 0},n.prototype.requestStarted=function(){var e;return this.recordTimingMetric("requestStart"),"function"==typeof(e=this.adapter).visitRequestStarted?e.visitRequestStarted(this):void 0},n.prototype.requestProgressed=function(e){var t;return this.progress=e,"function"==typeof(t=this.adapter).visitRequestProgressed?t.visitRequestProgressed(this):void 0},n.prototype.requestCompletedWithResponse=function(e,n){return this.response=e,null!=n&&(this.redirectedToLocation=t.Location.wrap(n)),this.adapter.visitRequestCompleted(this)},n.prototype.requestFailedWithStatusCode=function(e,t){return this.response=t,this.adapter.visitRequestFailedWithStatusCode(this,e)},n.prototype.requestFinished=function(){var e;return this.recordTimingMetric("requestEnd"),"function"==typeof(e=this.adapter).visitRequestFinished?e.visitRequestFinished(this):void 0},n.prototype.performScroll=function(){return this.scrolled?void 0:("restore"===this.action?this.scrollToRestoredPosition()||this.scrollToTop():this.scrollToAnchor()||this.scrollToTop(),this.scrolled=!0)},n.prototype.scrollToRestoredPosition=function(){var e,t;return null!=(e=null!=(t=this.restorationData)?t.scrollPosition:void 0)?(this.controller.scrollToPosition(e),!0):void 0},n.prototype.scrollToAnchor=function(){return null!=this.location.anchor?(this.controller.scrollToAnchor(this.location.anchor),!0):void 0},n.prototype.scrollToTop=function(){return this.controller.scrollToPosition({x:0,y:0})},n.prototype.recordTimingMetric=function(e){var t;return null!=(t=this.timingMetrics)[e]?t[e]:t[e]=(new Date).getTime()},n.prototype.getTimingMetrics=function(){return t.copyObject(this.timingMetrics)},i=function(e){switch(e){case"replace":return"replaceHistoryWithLocationAndRestorationIdentifier";case"advance":case"restore":return"pushHistoryWithLocationAndRestorationIdentifier"}},n.prototype.shouldIssueRequest=function(){return"restore"!==this.action||!this.hasCachedSnapshot()},n.prototype.cacheSnapshot=function(){return this.snapshotCached?void 0:(this.controller.cacheSnapshot(),this.snapshotCached=!0)},n.prototype.render=function(e){return this.cancelRender(),this.frame=requestAnimationFrame((t=this,function(){return t.frame=null,e.call(t)}));var t},n.prototype.cancelRender=function(){return this.frame?cancelAnimationFrame(this.frame):void 0},n}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};t.Controller=function(){function n(){this.clickBubbled=e(this.clickBubbled,this),this.clickCaptured=e(this.clickCaptured,this),this.pageLoaded=e(this.pageLoaded,this),this.history=new t.History(this),this.view=new t.View(this),this.scrollManager=new t.ScrollManager(this),this.restorationData={},this.clearCache(),this.setProgressBarDelay(500)}return n.prototype.start=function(){return t.supported&&!this.started?(addEventListener("click",this.clickCaptured,!0),addEventListener("DOMContentLoaded",this.pageLoaded,!1),this.scrollManager.start(),this.startHistory(),this.started=!0,this.enabled=!0):void 0},n.prototype.disable=function(){return this.enabled=!1},n.prototype.stop=function(){return this.started?(removeEventListener("click",this.clickCaptured,!0),removeEventListener("DOMContentLoaded",this.pageLoaded,!1),this.scrollManager.stop(),this.stopHistory(),this.started=!1):void 0},n.prototype.clearCache=function(){return this.cache=new t.SnapshotCache(10)},n.prototype.visit=function(e,n){var i,a;return null==n&&(n={}),e=t.Location.wrap(e),this.applicationAllowsVisitingLocation(e)?this.locationIsVisitable(e)?(i=null!=(a=n.action)?a:"advance",this.adapter.visitProposedToLocationWithAction(e,i)):window.location=e:void 0},n.prototype.startVisitToLocationWithAction=function(e,n,i){var a;return t.supported?(a=this.getRestorationDataForIdentifier(i),this.startVisit(e,n,{restorationData:a})):window.location=e},n.prototype.setProgressBarDelay=function(e){return this.progressBarDelay=e},n.prototype.startHistory=function(){return this.location=t.Location.wrap(window.location),this.restorationIdentifier=t.uuid(),this.history.start(),this.history.replace(this.location,this.restorationIdentifier)},n.prototype.stopHistory=function(){return this.history.stop()},n.prototype.pushHistoryWithLocationAndRestorationIdentifier=function(e,n){return this.restorationIdentifier=n,this.location=t.Location.wrap(e),this.history.push(this.location,this.restorationIdentifier)},n.prototype.replaceHistoryWithLocationAndRestorationIdentifier=function(e,n){return this.restorationIdentifier=n,this.location=t.Location.wrap(e),this.history.replace(this.location,this.restorationIdentifier)},n.prototype.historyPoppedToLocationWithRestorationIdentifier=function(e,n){var i;return this.restorationIdentifier=n,this.enabled?(i=this.getRestorationDataForIdentifier(this.restorationIdentifier),this.startVisit(e,"restore",{restorationIdentifier:this.restorationIdentifier,restorationData:i,historyChanged:!0}),this.location=t.Location.wrap(e)):this.adapter.pageInvalidated()},n.prototype.getCachedSnapshotForLocation=function(e){var t;return null!=(t=this.cache.get(e))?t.clone():void 0},n.prototype.shouldCacheSnapshot=function(){return this.view.getSnapshot().isCacheable()},n.prototype.cacheSnapshot=function(){var e,n;return this.shouldCacheSnapshot()?(this.notifyApplicationBeforeCachingSnapshot(),n=this.view.getSnapshot(),e=this.lastRenderedLocation,t.defer(function(t){
return function(){return t.cache.put(e,n.clone())}}(this))):void 0},n.prototype.scrollToAnchor=function(e){var t;return(t=this.view.getElementForAnchor(e))?this.scrollToElement(t):this.scrollToPosition({x:0,y:0})},n.prototype.scrollToElement=function(e){return this.scrollManager.scrollToElement(e)},n.prototype.scrollToPosition=function(e){return this.scrollManager.scrollToPosition(e)},n.prototype.scrollPositionChanged=function(e){return this.getCurrentRestorationData().scrollPosition=e},n.prototype.render=function(e,t){return this.view.render(e,t)},n.prototype.viewInvalidated=function(){return this.adapter.pageInvalidated()},n.prototype.viewWillRender=function(e){return this.notifyApplicationBeforeRender(e)},n.prototype.viewRendered=function(){return this.lastRenderedLocation=this.currentVisit.location,this.notifyApplicationAfterRender()},n.prototype.pageLoaded=function(){return this.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()},n.prototype.clickCaptured=function(){return removeEventListener("click",this.clickBubbled,!1),addEventListener("click",this.clickBubbled,!1)},n.prototype.clickBubbled=function(e){var t,n,i;return this.enabled&&this.clickEventIsSignificant(e)&&(n=this.getVisitableLinkForNode(e.target))&&(i=this.getVisitableLocationForLink(n))&&this.applicationAllowsFollowingLinkToLocation(n,i)?(e.preventDefault(),t=this.getActionForLink(n),this.visit(i,{action:t})):void 0},n.prototype.applicationAllowsFollowingLinkToLocation=function(e,t){return!this.notifyApplicationAfterClickingLinkToLocation(e,t).defaultPrevented},n.prototype.applicationAllowsVisitingLocation=function(e){return!this.notifyApplicationBeforeVisitingLocation(e).defaultPrevented},n.prototype.notifyApplicationAfterClickingLinkToLocation=function(e,n){return t.dispatch("turbolinks:click",{target:e,data:{url:n.absoluteURL},cancelable:!0})},n.prototype.notifyApplicationBeforeVisitingLocation=function(e){return t.dispatch("turbolinks:before-visit",{data:{url:e.absoluteURL},cancelable:!0})},n.prototype.notifyApplicationAfterVisitingLocation=function(e){return t.dispatch("turbolinks:visit",{data:{url:e.absoluteURL}})},n.prototype.notifyApplicationBeforeCachingSnapshot=function(){return t.dispatch("turbolinks:before-cache")},n.prototype.notifyApplicationBeforeRender=function(e){return t.dispatch("turbolinks:before-render",{data:{newBody:e}})},n.prototype.notifyApplicationAfterRender=function(){return t.dispatch("turbolinks:render")},n.prototype.notifyApplicationAfterPageLoad=function(e){return null==e&&(e={}),t.dispatch("turbolinks:load",{data:{url:this.location.absoluteURL,timing:e}})},n.prototype.startVisit=function(e,t,n){var i;return null!=(i=this.currentVisit)&&i.cancel(),this.currentVisit=this.createVisit(e,t,n),this.currentVisit.start(),this.notifyApplicationAfterVisitingLocation(e)},n.prototype.createVisit=function(e,n,i){var a,r,o,s,l;return s=(r=null!=i?i:{}).restorationIdentifier,o=r.restorationData,a=r.historyChanged,(l=new t.Visit(this,e,n)).restorationIdentifier=null!=s?s:t.uuid(),l.restorationData=t.copyObject(o),l.historyChanged=a,l.referrer=this.location,l},n.prototype.visitCompleted=function(e){return this.notifyApplicationAfterPageLoad(e.getTimingMetrics())},n.prototype.clickEventIsSignificant=function(e){return!(e.defaultPrevented||e.target.isContentEditable||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)},n.prototype.getVisitableLinkForNode=function(e){return this.nodeIsVisitable(e)?t.closest(e,"a[href]:not([target]):not([download])"):void 0},n.prototype.getVisitableLocationForLink=function(e){var n;return n=new t.Location(e.getAttribute("href")),this.locationIsVisitable(n)?n:void 0},n.prototype.getActionForLink=function(e){var t;return null!=(t=e.getAttribute("data-turbolinks-action"))?t:"advance"},n.prototype.nodeIsVisitable=function(e){var n;return!(n=t.closest(e,"[data-turbolinks]"))||"false"!==n.getAttribute("data-turbolinks")},n.prototype.locationIsVisitable=function(e){return e.isPrefixedBy(this.view.getRootLocation())&&e.isHTML()},n.prototype.getCurrentRestorationData=function(){return this.getRestorationDataForIdentifier(this.restorationIdentifier)},n.prototype.getRestorationDataForIdentifier=function(e){var t;return null!=(t=this.restorationData)[e]?t[e]:t[e]={}},n}()}.call(this),function(){!function(){var e,t;if((e=t=document.currentScript)&&!t.hasAttribute("data-turbolinks-suppress-warning"))for(;e=e.parentNode;)if(e===document.body)return console.warn("You are loading Turbolinks from a <script> element inside the <body> element. This is probably not what you meant to do!\n\nLoad your application\u2019s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.\n\nFor more information, see: https://github.com/turbolinks/turbolinks#working-with-script-elements\n\n\u2014\u2014\nSuppress this warning by adding a `data-turbolinks-suppress-warning` attribute to: %s",t.outerHTML)}()}.call(this),function(){var e,n,i;t.start=function(){return n()?(null==t.controller&&(t.controller=e()),t.controller.start()):void 0},n=function(){return null==window.Turbolinks&&(window.Turbolinks=t),i()},e=function(){var e;return(e=new t.Controller).adapter=new t.BrowserAdapter(e),e},(i=function(){return window.Turbolinks===t})()&&t.start()}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd&&define(t)}.call(this),
/**
 * Timeago is a jQuery plugin that makes it easy to support automatically
 * updating fuzzy timestamps (e.g. "4 minutes ago" or "about 1 day ago").
 *
 * @name timeago
 * @version 1.4.1
 * @requires jQuery v1.2.3+
 * @author Ryan McGeary
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 *
 * For usage and examples, visit:
 * http://timeago.yarp.com/
 *
 * Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)
 */
function(e){function t(){var t=n(this);return isNaN(t.datetime)||e(this).text(i(t.datetime)),this}function n(t){if(!(t=e(t)).data("timeago")){t.data("timeago",{datetime:r.datetime(t)});var n=e.trim(t.text());n.length>0&&t.attr("title",n)}return t.data("timeago")}function i(e){return r.inWords(a(e))}function a(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return t instanceof Date?i(t):i("string"==typeof t?e.timeago.parse(t):e.timeago.datetime(t))};var r=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(t){function n(n,a){var r=e.isFunction(n)?n(a,t):n,o=i.numbers&&i.numbers[a]||a;return r.replace(/%d/i,o)}var i=this.settings.strings,a=i.prefixAgo,r=i.suffixAgo;this.settings.allowFuture&&(t<0&&(a=i.prefixFromNow,r=i.suffixFromNow),t=Math.abs(t));var o=t/1e3,s=o/60,l=s/60,d=l/24,u=d/365,c=o<45&&n(i.seconds,Math.round(o))||o<90&&n(i.minute,1)||s<45&&n(i.minutes,Math.round(s))||s<90&&n(i.hour,1)||l<24&&n(i.hours,Math.round(l))||l<48&&n(i.day,1)||d<30&&n(i.days,Math.floor(d))||d<60&&n(i.month,1)||d<365&&n(i.months,Math.floor(d/30))||u<2&&n(i.year,1)||n(i.years,Math.floor(u));return e.trim([a,c,r].join(" "))},parse:function(t){var n=e.trim(t);return n=(n=(n=(n=n.replace(/\.\d\d\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)},datetime:function(t){var n="time"===e(t).get(0).tagName.toLowerCase()?e(t).attr("datetime"):e(t).attr("title");return r.parse(n)}}),e.fn.timeago=function(){var e=this;e.each(t);var n=r.settings;return n.refreshMillis>0&&setInterval(function(){e.each(t)},n.refreshMillis),e},document.createElement("abbr"),document.createElement("time")}(jQuery),function(e){window.NestedFormEvents=function(){this.addFields=e.proxy(this.addFields,this),this.removeFields=e.proxy(this.removeFields,this)},NestedFormEvents.prototype={addFields:function(t){var n=t.currentTarget,i=e(n).data("association"),a=e("#"+e(n).data("blueprint-id")).data("blueprint"),r=(e(n).closest(".fields").closestChild("input, textarea, select").eq(0).attr("name")||"").replace(new RegExp("[[a-z_]+]$"),"");if(r)for(var o=r.match(/[a-z_]+_attributes(?=\]\[(new_)?\d+\])/g)||[],s=r.match(/[0-9]+/g)||[],l=0;l<o.length;l++)s[l]&&(a=(a=a.replace(new RegExp("(_"+o[l]+")_.+?_","g"),"$1_"+s[l]+"_")).replace(new RegExp("(\\["+o[l]+"\\])\\[.+?\\]","g"),"$1["+s[l]+"]"));var d=new RegExp("new_"+i,"g"),u=this.newId();a=e.trim(a.replace(d,u));var c=this.insertFields(a,i,n);return c.trigger({type:"nested:fieldAdded",field:c}).trigger({type:"nested:fieldAdded:"+i,field:c}),!1},newId:function(){return(new Date).getTime()},insertFields:function(t,n,i){var a=e(i).data("target");return a?e(t).appendTo(e(a)):e(t).insertBefore(i)},removeFields:function(t){var n=e(t.currentTarget),i=n.data("association");n.prev("input[type=hidden]").val("1");var a=n.closest(".fields");return a.hide(),a.trigger({type:"nested:fieldRemoved",field:a}).trigger({type:"nested:fieldRemoved:"+i,field:a}),!1}},window.nestedFormEvents=new NestedFormEvents,e(document).on("click","form a.add_nested_fields",nestedFormEvents.addFields).on("click","form a.remove_nested_fields",nestedFormEvents.removeFields)}(jQuery),
/*
 * Copyright 2011, Tobias Lindig
 *
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 */
function(e){e.fn.closestChild=function(t){if(t&&""!=t){var n=[];for(n.push(this);n.length>0;)for(var i=n.shift().children(),a=0;a<i.length;++a){var r=e(i[a]);if(r.is(t))return r;n.push(r)}}return e()}}(jQuery);var wloc=window.location.toString();-1!==wloc.indexOf("api.")&&wloc.indexOf("api.")<20&&-1===wloc.indexOf("charts")&&-1===wloc.indexOf("plugins")&&(-1!==wloc.indexOf("-api.")?window.location=wloc.replace("api","web"):window.location=wloc.replace("api","www")),
/*
* Copyright (c) 2010 Lyconic, LLC.
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
*/
function(e){function t(t,i,a,r){l={dataType:"json"},1===arguments.length&&"string"!=typeof arguments[0]?"url"in(l=e.extend(l,t))&&"data"in l&&n(l.url,l.data):(e.isFunction(i)&&(r=a,a=i,i=null),t=n(t,i),l=e.extend(l,{url:t,data:i,success:a,error:r}))}function n(e,t){var n,i,a;for(n in t)a=t[n],(i=e.replace("{"+n+"}",a))!=e&&(e=i,delete t[n]);return e}function i(t){return t.type=t.type||"GET","string"!=typeof t.data&&null!=t.data&&(t.data=e.param(t.data)),t.data=t.data||"",e.restSetup.csrf&&!e.isEmptyObject(e.restSetup.csrf)&&(/^(get)$/i.test(t.type)||/(authenticity_token=)/i.test(t.data)||(t.data+=(t.data?"&":"")+e.restSetup.csrfParam+"="+$restSetup.csrfToken)),/^(get|post)$/i.test(t.type)||(t.data+=(t.data?"&":"")+e.restSetup.methodParam+"="+t.type.toLowerCase(),t.type="POST"),d.call(this,t)}function a(){return t.apply(this,arguments),e.extend(l,{type:"GET"}),e.ajax(l)}function r(){return t.apply(this,arguments),e.extend(l,{type:"POST"}),e.ajax(l)}function o(){return t.apply(this,arguments),e.extend(l,{type:"PUT"}),e.ajax(l)}function s(){return t.apply(this,arguments),e.extend(l,{type:"DELETE"}),e.ajax(l)}e.restSetup={methodParam:"_method"},e(document).ready(function(){e.extend(e.restSetup,{csrfParam:e("meta[name=csrf-param]").attr("content"),csrfToken:e("meta[name=csrf-token]").attr("content")})});var l,d=e.ajax;e.extend({ajax:i,read:a,create:r,update:o,destroy:s})}(jQuery),
/*
 * validate.js 1.0.1
 * Copyright (c) 2011 Rick Harrison, http://rickharrison.me
 * validate.js is open sourced under the MIT license.
 * Portions of validate.js are inspired by CodeIgniter.
 * http://rickharrison.github.com/validate.js
 */
function(e,t,n){var i={required:"The %s field is required.",matches:"The %s field does not match the %s field.",valid_email:"The %s field must contain a valid email address.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer."},a=function(){},r=/^(.+)\[(.+)\]$/,o=/^[0-9]+$/,s=/^\-?[0-9]+$/,l=/^\-?[0-9]*\.?[0-9]+$/,d=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,6}$/i,u=/^[a-z]+$/i,c=/^[a-z0-9]+$/i,h=/^[a-z0-9_-]+$/i,p=function(e,n,i){for(this.callback=i||a,this.errors=[],this.fields={},this.form=t.forms[e]||{},this.messages={},this.handlers={},e=0,i=n.length;e<i;e++){var r=n[e];r.name&&r.rules&&(this.fields[r.name]={name:r.name,display:r.display||r.name,rules:r.rules,type:null,value:null,checked:null})}this.form.onsubmit=function(e){return function(t){try{return e._validateForm(t)}catch(r){}}}(this)};p.prototype.setMessage=function(e,t){return this.messages[e]=t,this},p.prototype.registerCallback=function(e,t){return e&&"string"==typeof e&&t&&"function"==typeof t&&(this.handlers[e]=t),this},p.prototype._validateForm=function(e){for(var t in this.errors=[],this.fields)if(this.fields.hasOwnProperty(t)){var i=this.fields[t]||{},a=this.form[i.name];a&&a!==n&&(i.type=a.type,i.value=a.value,i.checked=a.checked),this._validateField(i)}if("function"==typeof this.callback&&this.callback(this.errors,e),this.errors.length>0){if(!e||!e.preventDefault)return!1;e.preventDefault()}return!0},p.prototype._validateField=function(e){var t=e.rules.split("|");if(-1!==e.rules.indexOf("required")||e.value&&""!==e.value&&e.value!==n)for(var a=0,o=t.length;a<o;a++){var s=t[a],l=null,d=!1;if((parts=r.exec(s))&&(s=parts[1],l=parts[2]),"function"==typeof this._hooks[s]?this._hooks[s].apply(this,[e,l])||(d=!0):"callback_"===s.substring(0,9)&&(s=s.substring(9,s.length),"function"==typeof this.handlers[s]&&!1===this.handlers[s].apply(this,[e.value])&&(d=!0)),d){(t=this.messages[s]||i[s])?(e=t.replace("%s",e.display),l&&(e=e.replace("%s",this.fields[l]?this.fields[l].display:l)),this.errors.push(e)):this.errors.push("An error has occurred with the "+e.display+" field.");break}}},p.prototype._hooks={required:function(e){var t=e.value;return"checkbox"===e.type?!0===e.checked:null!==t&&""!==t},matches:function(e,t){return!!(el=this.form[t])&&e.value===el.value},valid_email:function(e){return d.test(e.value)},min_length:function(e,t){return!!o.test(t)&&e.value.length>=t},max_length:function(e,t){return!!o.test(t)&&e.value.length<=t},exact_length:function(e,t){return!!o.test(t)&&e.value.length==t},greater_than:function(e,t){return!!l.test(e.value)&&parseFloat(e.value)>parseFloat(t)},less_than:function(e,t){return!!l.test(e.value)&&parseFloat(e.value)<parseFloat(t)},alpha:function(e){return u.test(e.value)},alpha_numeric:function(e){return c.test(e.value)},alpha_dash:function(e){return h.test(e.value)},numeric:function(e){return l.test(e.value)},integer:function(e){return s.test(e.value)}},e.FormValidator=p}(window,document),$(document).ready(function(){elementPresent($("#channel_form"))&&($(".field_checkbox").click(function(){var e=$(this).val(),t=$("#channel_field"+e);$(this).is(":checked")?(t.removeAttr("readonly").removeClass("custom-readonly"),t.val("Field Label "+e),t.select()):(t.val(""),t.attr("readonly",!0).addClass("custom-readonly"))}),$("#channel_show_location").click(function(){$(this).is(":checked")?($("#channel_longitude").removeAttr("disabled"),$("#channel_latitude").removeAttr("disabled"),$("#label_longitude").removeClass("label-disabled"),$("#label_latitude").removeClass("label-disabled")):($("#channel_longitude").attr("disabled",!0),$("#channel_latitude").attr("disabled",!0),$("#label_longitude").addClass("label-disabled"),$("#label_latitude").addClass("label-disabled"))}),$("#channel_show_video").click(function(){$(this).is(":checked")?($('[name="channel[video_type]"]:radio').removeAttr("disabled"),$("#channel_video_id").removeAttr("disabled"),$("#label_youtube").removeClass("label-disabled"),$("#label_vimeo").removeClass("label-disabled"),$("#label_video_id").removeClass("label-disabled")):($('[name="channel[video_type]"]:radio').attr("disabled",!0),$("#channel_video_id").attr("disabled",!0),$("#label_youtube").addClass("label-disabled"),$("#label_vimeo").addClass("label-disabled"),$("#label_video_id").addClass("label-disabled"))}),$("form").submit(function(){$('[name="channel[video_type]"]:radio').removeAttr("disabled"),unbindBeforeUnloadEvents()}),confirmUnsavedChanges())});var elementPresent=function(e){return"string"==typeof e?0!==$(e).length:0!==e.length},q=null;
// Copyright (C) 2006 Google Inc.
window.PR_SHOULD_USE_CONTINUATION=!0,function(){function e(e){function t(e){var t=e.charCodeAt(0);if(92!==t)return t;var n=e.charAt(1);return(t=c[n])?t:"0"<=n&&n<="7"?parseInt(e.substring(1),8):"u"===n||"x"===n?parseInt(e.substring(2),16):e.charCodeAt(1)}function n(e){return e<32?(e<16?"\\x0":"\\x")+e.toString(16):("\\"!==(e=String.fromCharCode(e))&&"-"!==e&&"["!==e&&"]"!==e||(e="\\"+e),e)}function i(e){for(var i=e.substring(1,e.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g),a=(e=[],[]),r="^"===i[0],o=r?1:0,s=i.length;o<s;++o){var l=i[o];if(/\\[bdsw]/i.test(l))e.push(l);else{var d;l=t(l);o+2<s&&"-"===i[o+1]?(d=t(i[o+2]),o+=2):d=l,a.push([l,d]),d<65||l>122||(d<65||l>90||a.push([32|Math.max(65,l),32|Math.min(d,90)]),d<97||l>122||a.push([-33&Math.max(97,l),-33&Math.min(d,122)]))}}for(a.sort(function(e,t){return e[0]-t[0]||t[1]-e[1]}),i=[],l=[NaN,NaN],o=0;o<a.length;++o)(s=a[o])[0]<=l[1]+1?l[1]=Math.max(l[1],s[1]):i.push(l=s);for(a=["["],r&&a.push("^"),a.push.apply(a,e),o=0;o<i.length;++o)s=i[o],a.push(n(s[0])),s[1]>s[0]&&(s[1]+1>s[0]&&a.push("-"),a.push(n(s[1])));return a.push("]"),a.join("")}function a(e){for(var t=e.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),n=t.length,a=[],s=0,l=0;s<n;++s){var d=t[s];"("===d?++l:"\\"===d.charAt(0)&&(d=+d.substring(1))&&d<=l&&(a[d]=-1)}for(s=1;s<a.length;++s)-1===a[s]&&(a[s]=++r);for(l=s=0;s<n;++s)"("===(d=t[s])?void 0===a[++l]&&(t[s]="(?:"):"\\"===d.charAt(0)&&(d=+d.substring(1))&&d<=l&&(t[s]="\\"+a[l]);for(l=s=0;s<n;++s)"^"===t[s]&&"^"!==t[s+1]&&(t[s]="");if(e.ignoreCase&&o)for(s=0;s<n;++s)e=(d=t[s]).charAt(0),d.length>=2&&"["===e?t[s]=i(d):"\\"!==e&&(t[s]=d.replace(/[A-Za-z]/g,function(e){return e=e.charCodeAt(0),"["+String.fromCharCode(-33&e,32|e)+"]"}));return t.join("")}for(var r=0,o=!1,s=!1,l=0,d=e.length;l<d;++l){var u=e[l];if(u.ignoreCase)s=!0;else if(/[a-z]/i.test(u.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){o=!0,s=!1;break}}var c={b:8,t:9,n:10,v:11,f:12,r:13},h=[];for(l=0,d=e.length;l<d;++l){if((u=e[l]).global||u.multiline)throw Error(""+u);h.push("(?:"+a(u)+")")}return RegExp(h.join("|"),s?"gi":"g")}function t(e){function t(e){switch(e.nodeType){case 1:if(i.test(e.className))break;for(var n=e.firstChild;n;n=n.nextSibling)t(n);"BR"!==(n=e.nodeName)&&"LI"!==n||(a[s]="\n",o[s<<1]=r++,o[s++<<1|1]=e);break;case 3:case 4:(n=e.nodeValue).length&&(n=l?n.replace(/\r\n?/g,"\n"):n.replace(/[\t\n\r ]+/g," "),a[s]=n,o[s<<1]=r,r+=n.length,o[s++<<1|1]=e)}}var n,i=/(?:^|\s)nocode(?:\s|$)/,a=[],r=0,o=[],s=0;e.currentStyle?n=e.currentStyle.whiteSpace:window.getComputedStyle&&(n=document.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var l=n&&"pre"===n.substring(0,3);return t(e),{a:a.join("").replace(/\n$/,""),c:o}}function n(e,t,n,i){t&&(n(e={a:t,d:e}),i.push.apply(i,e.e))}function i(t,i){function a(e){for(var t=e.d,d=[t,"pln"],u=0,c=e.a.match(r)||[],h={},p=0,f=c.length;p<f;++p){var m,g=c[p],_=h[g],v=void 0;if("string"==typeof _)m=!1;else{var y=o[g.charAt(0)];if(y)v=g.match(y[1]),_=y[0];else{for(m=0;m<l;++m)if(y=i[m],v=g.match(y[1])){_=y[0];break}v||(_="pln")}!(m=_.length>=5&&"lang-"===_.substring(0,5))||v&&"string"==typeof v[1]||(m=!1,_="src"),m||(h[g]=_)}if(y=u,u+=g.length,m){m=v[1];var b=g.indexOf(m),w=b+m.length;v[2]&&(b=(w=g.length-v[2].length)-m.length),_=_.substring(5),n(t+y,g.substring(0,b),a,d),n(t+y+b,m,s(_,m),d),n(t+y+w,g.substring(w),a,d)}else d.push(t+y,_)}e.e=d}var r,o={};!function(){for(var n=t.concat(i),a=[],s={},l=0,d=n.length;l<d;++l){var u=n[l],c=u[3];if(c)for(var h=c.length;--h>=0;)o[c.charAt(h)]=u;c=""+(u=u[1]),s.hasOwnProperty(c)||(a.push(u),s[c]=q)}a.push(/[\S\s]/),r=e(a)}();var l=i.length;return a}function a(e){var t=[],n=[];e.tripleQuotedStrings?t.push(["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,q,"'\""]):e.multiLineStrings?t.push(["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,q,"'\"`"]):t.push(["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,q,"\"'"]),e.verbatimStrings&&n.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,q]);var a=e.hashComments;return a&&(e.cStyleComments?(a>1?t.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,q,"#"]):t.push(["com",/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\n\r]*)/,q,"#"]),n.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,q])):t.push(["com",/^#[^\n\r]*/,q,"#"])),e.cStyleComments&&(n.push(["com",/^\/\/[^\n\r]*/,q]),n.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,q])),e.regexLiterals&&n.push(["lang-regex",/^(?:^^\.?|[!+-]|!=|!==|#|%|%=|&|&&|&&=|&=|\(|\*|\*=|\+=|,|-=|->|\/|\/=|:|::|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|[?@[^]|\^=|\^\^|\^\^=|{|\||\|=|\|\||\|\|=|~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\s*(\/(?=[^*/])(?:[^/[\\]|\\[\S\s]|\[(?:[^\\\]]|\\[\S\s])*(?:]|$))+\/)/]),(a=e.types)&&n.push(["typ",a]),(e=(""+e.keywords).replace(/^ | $/g,"")).length&&n.push(["kwd",RegExp("^(?:"+e.replace(/[\s,]+/g,"|")+")\\b"),q]),t.push(["pln",/^\s+/,q," \r\n\t\xa0"]),n.push(["lit",/^@[$_a-z][\w$@]*/i,q],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,q],["pln",/^[$_a-z][\w$@]*/i,q],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,q,"0123456789"],["pln",/^\\[\S\s]?/,q],["pun",/^.[^\s\w"-$'./@\\`]*/,q]),i(t,n)}function r(e,t){function n(e){switch(e.nodeType){case 1:if(r.test(e.className))break;if("BR"===e.nodeName)i(e),e.parentNode&&e.parentNode.removeChild(e);else for(e=e.firstChild;e;e=e.nextSibling)n(e);break;case 3:case 4:if(l){var t=e.nodeValue,a=t.match(o);if(a){var d=t.substring(0,a.index);e.nodeValue=d,(t=t.substring(a.index+a[0].length))&&e.parentNode.insertBefore(s.createTextNode(t),e.nextSibling),i(e),d||e.parentNode.removeChild(e)}}}}function i(e){function t(e,n){var i=n?e.cloneNode(!1):e;if(a=e.parentNode){var a=t(a,1),r=e.nextSibling;a.appendChild(i);for(var o=r;o;o=r)r=o.nextSibling,a.appendChild(o)}return i}for(;!e.nextSibling;)if(!(e=e.parentNode))return;var n;for(e=t(e.nextSibling,0);(n=e.parentNode)&&1===n.nodeType;)e=n;d.push(e)}var a,r=/(?:^|\s)nocode(?:\s|$)/,o=/\r\n?|\n/,s=e.ownerDocument;e.currentStyle?a=e.currentStyle.whiteSpace:window.getComputedStyle&&(a=s.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var l=a&&"pre"===a.substring(0,3);for(a=s.createElement("LI");e.firstChild;)a.appendChild(e.firstChild);for(var d=[a],u=0;u<d.length;++u)n(d[u]);t===(0|t)&&d[0].setAttribute("value",t);var c=s.createElement("OL");c.className="linenums";for(var h=Math.max(0,t-1|0)||0,p=(u=0,d.length);u<p;++u)(a=d[u]).className="L"+(u+h)%10,a.firstChild||a.appendChild(s.createTextNode("\xa0")),c.appendChild(a);e.appendChild(c)}function o(e,t){for(var n=t.length;--n>=0;){var i=t[n];y.hasOwnProperty(i)?window.console&&console.warn("cannot override language handler %s",i):y[i]=e}}function s(e,t){return e&&y.hasOwnProperty(e)||(e=/^\s*</.test(t)?"default-markup":"default-code"),y[e]}function l(e){var n=e.g;try{var i=(c=t(e.h)).a;e.a=i,e.c=c.c,e.d=0,s(n,i)(e);var a,r,o=/\bMSIE\b/.test(navigator.userAgent),l=(n=/\n/g,e.a),u=l.length,c=0,h=e.c,p=h.length,f=(i=0,e.e),m=f.length;e=0;for(f[m]=u,r=a=0;r<m;)f[r]!==f[r+2]?(f[a++]=f[r++],f[a++]=f[r++]):r+=2;for(m=a,r=a=0;r<m;){for(var g=f[r],_=f[r+1],v=r+2;v+2<=m&&f[v+1]===_;)v+=2;f[a++]=g,f[a++]=_,r=v}for(f.length=a;i<p;){var y,b=h[i+2]||u,w=f[e+2]||u,$=(v=Math.min(b,w),h[i+1]);if(1!==$.nodeType&&(y=l.substring(c,v))){o&&(y=y.replace(n,"\r")),$.nodeValue=y;var x=$.ownerDocument,k=x.createElement("SPAN");k.className=f[e+1];var E=$.parentNode;E.replaceChild(k,$),k.appendChild($),c<b&&(h[i+1]=$=x.createTextNode(l.substring(v,b)),E.insertBefore($,k.nextSibling))}(c=v)>=b&&(i+=2),c>=w&&(e+=2)}}catch(d){"console"in window&&console.log(d&&d.stack?d.stack:d)}}var d,u,c=[d=[[u=["break,continue,do,else,for,if,return,while"],"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],h=[d,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"],p=[h,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"],f=[u,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],m=[u,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],g=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/,_=/\S/,v=a({keywords:[c,p,d=[d,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"],"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END"+f,m,u=[u,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"]],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),y={};o(v,["default-code"]),o(i([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]),o(i([["pln",/^\s+/,q," \t\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,q,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'/>]|\/(?=\s)))/],["pun",/^[/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]),o(i([],[["atv",/^[\S\s]+/]]),["uq.val"]),o(a({keywords:c,hashComments:!0,cStyleComments:!0,types:g}),["c","cc","cpp","cxx","cyc","m"]),o(a({keywords:"null,true,false"}),["json"]),o(a({keywords:p,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:g}),["cs"]),o(a({keywords:h,cStyleComments:!0}),["java"]),o(a({keywords:u,hashComments:!0,multiLineStrings:!0}),["bsh","csh","sh"]),o(a({keywords:f,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py"]),o(a({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["perl","pl","pm"]),o(a({keywords:m,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb"]),o(a({keywords:d,cStyleComments:!0,regexLiterals:!0}),["js"]),o(a({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]),o(i([],[["str",/^[\S\s]+/]]),["regex"]),window.prettyPrintOne=function(e,t,n){var i=document.createElement("PRE");return i.innerHTML=e,n&&r(i,n),l({g:t,i:n,h:i}),i.innerHTML},window.prettyPrint=function(e){function t(){for(var n=window.PR_SHOULD_USE_CONTINUATION?d.now()+250:Infinity;u<i.length&&d.now()<n;u++){var a=i[u];if((o=a.className).indexOf("prettyprint")>=0){var o,s,h;if(h=!(o=o.match(c))){for(var p=void 0,f=(h=a).firstChild;f;f=f.nextSibling){var m=f.nodeType;p=1===m?p?h:f:3===m&&_.test(f.nodeValue)?h:p}h=(s=p===h?void 0:p)&&"CODE"===s.tagName}for(h&&(o=s.className.match(c)),o&&(o=o[1]),h=!1,p=a.parentNode;p;p=p.parentNode)if(("pre"===p.tagName||"code"===p.tagName||"xmp"===p.tagName)&&p.className&&p.className.indexOf("prettyprint")>=0){h=!0;break}h||((h=!!(h=a.className.match(/\blinenums\b(?::(\d+))?/))&&(!h[1]||!h[1].length||+h[1]))&&r(a,h),l({g:o,h:a,i:h}))}}u<i.length?setTimeout(t,250):e&&e()}for(var n=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],i=[],a=0;a<n.length;++a)for(var o=0,s=n[a].length;o<s;++o)i.push(n[a][o]);n=q;var d=Date;d.now||(d={now:function(){return+new Date}});var u=0,c=/\blang(?:uage)?-([\w.]+)(?!\S)/;t()},window.PR={createSimpleLexer:i,registerLangHandler:o,sourceDecorator:a,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ"}}(),(0,window.jQuery)(function(){window.prettyPrint&&prettyPrint()}),$(document).ready(function(){$(".response").click(function(){var e=$(this).data("response_type");$(".response").removeClass("active"),$(".response-"+e).addClass("active"),$(".format").hide(),$(".format-"+e).show()})});var evalContainer,fevalContainer,evalDiv,fevalDiv,fevalImg,hiddenMcode,hiddenErrorTitle,hiddenTimeoutTitle,hiddenSuccessTitle,hiddenErrorMessage,unsavedChangesMessage,errored,erroredMessage,timeOutDetailText,codeEditor,alerts={showBanners:function(e){var t=document.getElementById(e);"none"===t.style.display&&(t.style.display="block"),t.scrollIntoView(!1)},hideBanners:function(e){var t=document.getElementById(e);"block"===t.style.display&&(t.style.display="none")},displayErrorAlert:function(e){alerts.showBanners(e)}},analysis_visualization_name_save={onmouseclick:function(e,t){$(e).val().trim()?($(e).val(xssEvasion.sanitizeResponse($(e).val().trim())),saveType="mouseClick",e.form.save.click()):alerts.displayErrorAlert(t)},onkeypress:function(e,t){13==event.keyCode&&(event.preventDefault(),$(e).val().trim()?($(e).val(xssEvasion.sanitizeResponse($(e).val().trim())),saveType="enter",e.form.save.click()):alerts.displayErrorAlert(t))}};$("#analysis_name_empty_error_close").on("click",function(){alerts.hideBanners(this.parentElement.id)}),$("#matlab_code_empty_warning_close").on("click",function(){alerts.hideBanners(this.parentElement.id)});var mssInit=function(){evalContainer=$("#eval_container .card-body"),fevalContainer=$("#feval_container .card-body"),evalDiv=$("#eval"),fevalDiv=$("#feval_svg"),fevalImg=$("#feval_png"),hiddenMcode=getHiddenMcodeDiv(),hiddenErrorTitle=$("#error_title").val(),hiddenTimeoutTitle=$("#timeout_title").val(),timeOutDetailText=$("#timeout_detailed").val(),hiddenSuccessTitle=$("#success_title").val(),hiddenErrorMessage=$("#error_message").val(),unsavedChangesMessage=$("#unsaved_changes").val(),errored=$("#errored"),erroredMessage=$("#errored_timecontrol_react").val(),""!==hiddenErrorMessage&&displayError(hiddenErrorMessage),$("#clear").click(function(){clearHistory(),clearFEvalResponse()}),$(window).unbind("beforeunload.matlab").bind("beforeunload.matlab",function(){if(matlabEditor.rtcPresent()&&unsavedChanges())return unsavedChangesMessage}),$(document).unbind("page:before-change.matlab").bind("page:before-change.matlab",function(){if(matlabEditor.rtcPresent()&&unsavedChanges()&&!confirm(unsavedChangesMessage))return!1})},onEditorLoad=function(){$("#editorSpinner").hide(),codeEditor=window.editor.rtcInstance.getDocument(),matlabEditor.checkCodeChange(),mssInit(),matlabEditor.setMcode(),$("#commit").click(function(){matlabEditor.uiLock(),$(".dismiss").click(),hiddenMcode.val(matlabEditor.getMcode())}),$("#save").click(function(){"enter"!=saveType&&"mouseClick"!=saveType&&matlabEditor.uiLock(),$(".dismiss").click(),hiddenMcode.val(matlabEditor.getMcode())}),$("#analytics_text_field").length>0&&matlabEditor.checkMatlabFileNameChange()},isPlugin=function(){return elementPresent(fevalContainer)},isMatlabIotAnalytic=function(){return elementPresent($("#matlab_iot_analytic_mcode"))},getHiddenMcodeDiv=function(){var e;return e=isMatlabIotAnalytic()?"#matlab_iot_analytic_mcode":isPlugin()?"#plugin_mcode":"#matlab_code_mcode",$(e)},unsavedChanges=(elementPresent=function(e){return"string"==typeof e?0!==$(e).length:0!==e.length},function(){return matlabEditor.getMcode()!==(hiddenMcode.val()||"")}),clearFEvalResponse=function(){elementPresent(fevalDiv)&&fevalDiv.children().remove(),elementPresent(fevalImg)&&(fevalImg.removeAttr("src"),fevalImg.hide())},clearHistory=function(){elementPresent(evalDiv)&&evalDiv.children().remove()},handleMSSResponse=function(e){if("error"in e&&null!==e.error)displayError(e.error),clearFEvalResponse();else if(displaySuccess(hiddenSuccessTitle),elementPresent(evalDiv)&&"eval"in e&&appendOutput(e.eval,!1),elementPresent(fevalDiv)&&"feval"in e){var t=e.feval;clearFEvalResponse(),"ggjson"in t&&null!==t.ggjson?handleWebPlotResponse(t.ggjson):"hgplot"in t&&null!==t.hgplot&&handlePlotResponse(t.hgplot)}},handleMSSResponseIotAnalytics=function(e){if($("#eval_container").removeClass("d-none"),"error"in e&&null!==e.error)displayError(e.error),clearFEvalResponse();else if(displaySuccess(hiddenSuccessTitle),elementPresent(evalDiv)&&"eval"in e&&appendOutput(e.eval,!1),"feval"in e){var t=e.feval;clearFEvalResponse(),"ggjson"in t&&null!==t.ggjson?($("#feval_container").removeClass("d-none"),handleWebPlotResponse(t.ggjson)):"hgplot"in t&&null!==t.hgplot?($("#feval_container").removeClass("d-none"),handlePlotResponse(t.hgplot)):$("#feval_container").addClass("d-none")}},handlePlotResponse=function(e){fevalImg.attr("src",e).show()},handleWebPlotResponse=function(e){var t=JSON.parse(e);renderVega(t,"#feval_svg"),fevalImg.hide()},appendOutput=function(e,t){if(""!==e&&null!==e&&e!==undefined){var n=document.createElement("div");!0===t&&$(n).addClass("matlab_warning");var i=xssEvasion.sanitizeResponse(e);if(n.innerHTML=i.trim(),elementPresent(evalDiv)){var a=$(n).find("a");a.length>0&&$(a).click(interceptErrorUrl),$(document.createElement("hr")).appendTo(n),$(n).appendTo(evalDiv),$(evalDiv).scrollTop($(evalDiv).prop("scrollHeight"))}}},displayError=function(e,t){t===undefined&&(t="#root");var n=hiddenErrorTitle;"true"===errored.val()&&(n+=" "+erroredMessage),e===timeOutDetailText&&(n=hiddenTimeoutTitle),$('<div class="flash alert alert-danger"><span class="dismiss"><i class="fa fa-close"></i></span><p>'+n+"</p></div").insertBefore(t),$(".flash a").click(interceptErrorUrl),$(".dismiss").on("click",function(){$(this).parent().remove()}),appendOutput(e,!0)},displaySuccess=function(e,t){t===undefined&&(t="#root"),$(".alert-success").remove(),$('<div class="flash alert alert-success"><span class="dismiss"><i class="fa fa-close"></i></span><p>'+e+"</p></div").insertBefore(t),$(".dismiss").on("click",function(){$(this).parent().remove()}),setTimeout(function(){$("div.flash.alert.alert-success").length>0&&$(".flash").hide("slow")},15e3)},displayErrorFormElements=function(e,t){t===undefined&&(t="#root"),$(".alert-danger").remove(),$('<div class="flash alert alert-danger"><span class="dismiss"><i class="fa fa-close"></i></span><p class="word_break_normal" id="error_message_p"> </p></div>').insertBefore(t),$("#error_message_p").append(e),$(".dismiss").on("click",function(){$(this).parent().remove()})},interceptErrorUrl=function(e){"http"!==this.href.substring(0,4)&&(e.preventDefault(),evalErrorUrl(this.href,function(e){null!==e&&"eval"in e&&appendOutput(e.eval,!1)}))},evalErrorUrl=function(e,t){if(-1!==e.indexOf("matlab:")){var n=e.substring(0,7);if("matlab:"===n){var i=e.substring(7);"doc"===(n=i.substring(0,3))?(i=i.substring(4),window.open("http://www.mathworks.com/help/search.html?qdoc="+i)):$.ajax({method:"POST",url:"test_code",data:{mcode:i},dataType:"json"}).done(function(e){t(e)})}}},renderVega=function(e,t){var n=new thingSpeakWebplot;e.resizable=!0,e.resizableButtonVisible=!1,!1!==n.setSpec(e,t)&&(n.loadLibraries(),n.render(),n.resize())},matlabEditor={checkCodeChange:function(){document.getElementById("solutionBodyArea").onkeyup=function(){parent.document.getElementById("saveNeeded")&&(parent.document.getElementById("saveNeeded").innerHTML="*")}},rtcPresent:function(){return void 0!==codeEditor},setMcode:function(){matlabEditor.rtcPresent()&&codeEditor.setText(hiddenMcode.val())},getMcode:function(){if(matlabEditor.rtcPresent())return codeEditor.getText()},uiUnlock:function(){matlabEditor.rtcPresent()&&(window.editor.rtcInstance.focus(),codeEditor.setReadOnly(!1))},uiLock:function(){matlabEditor.rtcPresent()&&(window.editor.rtcInstance.blur(),window.editor.resizeEditor(),codeEditor.setReadOnly(!0))},checkMatlabFileNameChange:function(){document.getElementById("analytics_text_field").onkeypress=function(){parent.document.getElementById("saveNeeded")&&(parent.document.getElementById("saveNeeded").innerHTML="*")}}},setExhaustionAlertDefaults=function(){is_shutOff=!1,is_leu=!1,exhuastion_message_id="#call_of_action_exhaust",shut_off_message_id="#call_of_action_shutoff",expire_message_id="#call_of_action_expire",to_expire_message_id="#call_of_action_to_expire",$(".exhaustion_reminder").hide(),$(".expiration_reminder").hide(),$(".shutoff_alert").hide(),$(".shutoff_expiration_alert").hide(),currentDate=new Date,a_tag_id=null},checkMessageExhaustion=function(e,t,n,i,a,r){var o=!1;if(estimated_exhaustion_date=UsageVisualizations.estimateExhaustionOrExpirationDate(i.monthly,i.daily,r).Date,t.dateType=UsageVisualizations.estimateExhaustionOrExpirationDate(i.monthly,i.daily,r).DateType,1==is_shutOff)$("#license_id_val").text(e),$("#shut_off_date").text(moment(t.exhaustion_date).format("LL")),$(".shutoff_alert").show(),a!=undefined&&!0===a&&(o=!0);else if(t.dateType!=undefined&&"Expiration Date"===t.dateType&&estimated_exhaustion_date<currentDate)setExpirationAlert(e,n,!0),$("#license_id_val_expire_shutoff").text(e),$("#shut_off_date_exp").text(moment(estimated_exhaustion_date).format("LL")),n||$(".shutoff_expiration_alert").show();else{var s=Math.abs(estimated_exhaustion_date.getTime()-(new Date).getTime());Math.ceil(s/864e5)<=45&&(o=!0,t.dateType!=undefined&&"Expiration Date"===t.dateType?($("#license_id_val_expire").text(e),$("#expiration_date").text(moment(estimated_exhaustion_date).format("LL")),n||(setExpirationAlert(e,n,!1),$(".expiration_reminder").show())):(setExpirationAlert(e,n,!1),$("#license_id_val_exhaust").text(e),$("#exp_expiration_date").text(moment(estimated_exhaustion_date).format("LL")),$(".exhaustion_reminder").show()))}a!=undefined&&!0===a&&!0===o&&$("#monthly_usage_tab").is(":visible")&&$('#charts_tabs a[href="#monthly_usage"]').tab("show")},populateFreeUnitsLink=function(e){1!=e?$(exhuastion_message_id).attr("href","/prices"):$(shut_off_message_id).attr("href","/prices")},populateAlertMessages=function(e,t){1==is_leu?setMessageForLEU(t):setMessageForNonLEU(e,t)},setMessageForLEU=function(e){setAdminContactMessage(1!=e?exhuastion_message_id:shut_off_message_id)},setMessageForNonLEU=function(e,t){setPurchaseUnitsMessage(1!=t?exhuastion_message_id:shut_off_message_id,e)},populatePurchaseUnitsLink=function(e){$("#purchase_units_link").attr("href","/account/purchase/"+encodeURIComponent(e))},setAdminContactMessage=function(e){$(e).text("Contact your administrator.").removeClass("exhaustion_alert").removeAttr("href").addClass("contact_admin")},setPurchaseUnitsMessage=function(e,t){$(e).text("Purchase more units").attr("href","/account/purchase/"+encodeURIComponent(t)).attr("data-turbolinks",!1)},setExpirationAlert=function(e,t,n){a_tag_id=1==n?expire_message_id:to_expire_message_id,1==t?$(a_tag_id).attr("href","/prices"):1==is_leu?$(a_tag_id).text("Contact your administrator.").removeClass("exhaustion_alert").removeAttr("href").addClass("contact_admin"):$(a_tag_id).text("Purchase more units").attr("href","/account/purchase/"+encodeURIComponent(e)).attr("data-turbolinks",!1)};ThingSpeak.Channel=function(){function e(e){for(var t in this.channel=e.channel,this.publicView=e.public_view,this.currentUserOwns=e.current_user_owns,this.windows=[],$("abbr.timeago").timeago(),e.windows)this.windows.push(ThingSpeak.Window.init(e.windows[t],this.currentUserOwns));if($("#add_widget_modal").on("show.bs.modal",function(){document.getElementById("add_widget_next").disabled=!0,widgetPreview.resetSettings(),widgetPreview.showPreviewPane()}),$("#add_widget_next").click(function(){widgetPreview.showWidgetForm()}.bind(this)),$(".add_widget_cancel").click(function(){widgetPreview.resetSettings()}.bind(this)),$("#configure_widget_parameters_modal").on("shown.bs.modal",function(){widgetPreviewHelpers.gaugeToggleDisplayCheckBox(this)}.bind(this)),$("#configure_widget_parameters_modal").on("hide.bs.modal",function(){$("#gauge_min_max_error").hide(),$("#units_error").hide(),widgetPreview.resetSettings()}),$("#invalid_widget_parameter_close").on("click",function(){$(this).parent().hide()}),$("#invalid_widget_type_close").on("click",function(){$(this).parent().hide()}),$(document).on("click","#gauge_add_range_",function(){widgetHelperFunctions.gaugePlusButtonHelper("widget_params_config_")}),$(document).on("click","[id^=range_close_icon]",function(e){gaugeRemoveRange(e.target.parentElement)}),$(document).on("click","#gauge_min_max_error_close",function(){widgetHelperFunctions.hideGaugeMinMaxError(this)}),$(document).on("click","#units_error_close",function(){widgetHelperFunctions.hideUnitsError(this)}),$("#add_widget_create").click(function(){var e=$(".window-preview-container-selected").find("#widget-metadata-id").html(),t=$("#configure_widget_parameters_modal").find("#gauge_min_max_error"),n=$("#configure_widget_parameters_modal").find("#units_error"),i=widgetHelperFunctions.validateAndGetWidgetData(e,t,n);if(!i)return!1;var a=this.publicView,r=widgetHelperFunctions.getWidgetWindow(e,i,a);$(this).toggleClass("window-preview-container-selected"),ThingSpeak.Window.addWidgetWindow(this.channel.id,r),$("#configure_widget_parameters_modal").modal("hide")}.bind(this)),$("#add_visualization_modal").on("show.bs.modal",function(){hiddenText=$("#add_visualization_empty_text"),$("#add_visualization_modal_content_body").children("div").length>0?hiddenText.attr("hidden","hidden"):hiddenText.removeAttr("hidden")}),$(".window-preview-container").click(function(){widgetPreview.selectCurrentWindow(),$(this).toggleClass("window-preview-container-selected")}),$("#add_visualization_cancel").click(function(){$(".window-preview-container-selected").removeClass("window-preview-container-selected")}),$("#add_visualization_save").click(function(){var e=this.publicView,t=[],n={};$(".window-preview-container-selected").each(function(i,a){$(a).remove(),n={public_flag:e,content_type:$(a).attr("content-type"),content_id:$(a).attr("content-id")},t.push(n)}),ThingSpeak.Window.addVisualizations(this.channel.id,t)}.bind(this)),this.currentUserOwns){var n=function(){var e=[];$(".window-container").each(function(t,n){e.push(n.id.split("_")[1])});var t="/channels/"+this.channel.id+"/windows/reposition",n={public_flag:this.publicView,window_ids:e};$.ajax({url:t,method:"PUT",data:n,dataType:"json"})}.bind(this);this.sortable=Sortable.create($("#windows_container")[0],{sort:!0,delay:0,animation:150,handle:".window-header",draggable:".window-container",scroll:!0,scrollSensitivity:70,scrollSpeed:10,fallbackOnBody:!1,onEnd:n})}return this}return{init:function(t){return new e(t)},addVisualizationPreview:function(e){var t=$.parseHTML(e);$(t).click(function(){$(this).toggleClass("window-preview-container-selected")}),$("#add_visualization_modal_content_body").append(t)}}}();var monthlyData,dailyData,loadMeterData=function(e){var t;$("#available_licenses").change(function(){var e=this.value,t=$("#channel-metadata-id").html();$.ajax({url:"/channels/update_license",method:"POST",data:{channel_id:t,license:e},dataType:"html"})}),t=e.is_free_user?e.free_license_id:e.is_a_staff?e.staff_license_id:$("#available_licenses").val(),loadMeterInfo(t),$("#available_licenses").change(function(){loadMeterInfo($("#available_licenses").val())})},setDefaultsChannels=function(){$("input#upload_csv_channel_btn").removeAttr("disabled")},loadMeterInfo=function(e){var t;setExhaustionAlertDefaults(),setDefaultsChannels(),1==meter_data.is_free_user?(1==meter_data.has_exhausted&&(is_shutOff=!0,t="Importing data into a channel requires messages. Buy a new license."),populateFreeUnitsLink(is_shutOff)):meter_data.licenses.forEach(function(n){n.license_id==e&&(null!=n.has_exhausted&&(is_shutOff=!0,t="Importing data into a channel requires messages. Purchase more units."),1==n.is_an_leu&&(is_leu=!0,t="Importing data into a channel requires messages. Contact your license administrator."),populatePurchaseUnitsLink(e),populateAlertMessages(e,is_shutOff))}),findDailyAndMonthlyUsage(e),!0===is_shutOff&&($("input#upload_csv_channel_btn").addClass("enable_events_disabled_elements"),$("input#upload_csv_channel_btn").attr("disabled","disabled"),$("input#upload_csv_channel_btn").attr("title",t))},findDailyAndMonthlyUsage=function(e){var t=!1,n={daily:undefined,monthly:undefined},i={userType:meter_data.user_type},a=0;meter_data.is_free_user||jQuery.isEmptyObject(meter_data.licenses)||meter_data.licenses.forEach(function(n){n.license_id==e&&(t=n.is_an_leu,a=n.total_remaining_messages_per_license)}),meter_data.is_free_user?(i.number_of_messages_per_unit=meter_data.free_messages_per_year,i.messages_remaining=meter_data.licenses[0].messages_remaining):(i.number_of_messages_per_unit=meter_data.messages_per_paid_unit,i.messages_remaining=a);var r=function(e){n.daily=e,s(n)},o=function(e){n.monthly=e,s(n)},s=function(t){t.daily&&t.monthly&&checkMessageExhaustion(e,meter_data,meter_data.is_free_user,n,!1,i)},l=5e3;$.ajax({url:"/account/daily_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",tryCount:0,retryLimit:1,timeout:l}).done(r).fail(function(e){if(200!=e.status&&304!=e.status)return this.tryCount++,this.tryCount<=this.retryLimit?void $.ajax(this):void 0}),$.ajax({url:"/account/monthly_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",tryCount:0,retryLimit:1,timeout:l}).done(o).fail(function(e){if(200!=e.status&&304!=e.status)return this.tryCount++,this.tryCount<=this.retryLimit?void $.ajax(this):void 0})},usagePurposeModal={showHideUsageModal:function(){!1===usage_purpose_modal_flag?usagePurposeModal.setModalFields():new bootstrap.Modal(document.getElementById("usage_purpose_modal")).hide()},setModalFields:function(){usagePurposeModal.setModalDefaults(),usagePurposeModal.setModalOptionsForCommGov(),usagePurposeModal.setModalOptionsForNonCommGov(),usagePurposeModal.setModalOptionsForAcademic(),usagePurposeModal.setModalOptionsForNonAcademic()},setModalDefaults:function(){new bootstrap.Modal(document.getElementById("usage_purpose_modal"),{backdrop:"static",keyboard:!1}).show(),$("#submit_intent_of_use").attr("disabled","disableClick"),$("#company_name").hide(),$(".academic_use").hide()},setModalOptionsForCommGov:function(){$("#usage_purpose_modal").on("click","#extended_user_detail_intended_use_0, #extended_user_detail_intended_use_1",function(){$("#company_name").show(),usagePurposeModal.toggleOkButtonForCompany()})},setModalOptionsForNonCommGov:function(){$("#usage_purpose_modal").on("click","#extended_user_detail_intended_use_2, #extended_user_detail_intended_use_3",function(){$("#company_name").hide(),$("#extended_user_detail_company_name").val(null),$("#submit_intent_of_use").removeAttr("disabled")})},setModalOptionsForAcademic:function(){$("#usage_purpose_modal").on("click","#extended_user_detail_intended_use_3",function(){$(".academic_use").show(),usagePurposeModal.toggleOkButtonForAcademic()})},setModalOptionsForNonAcademic:function(){$("#usage_purpose_modal").on("click","#extended_user_detail_intended_use_0, #extended_user_detail_intended_use_1, #extended_user_detail_intended_use_2",function(){$(".academic_use").hide(),$("#extended_user_detail_university_name").val(null),$("#extended_user_detail_course_name").val(null)})},toggleOkButtonForCompany:function(){
""===$.trim($("#extended_user_detail_company_name").val())?$("#submit_intent_of_use").attr("disabled","disableClick"):$("#submit_intent_of_use").removeAttr("disabled")},toggleOkButtonForAcademic:function(){""===$.trim($("#extended_user_detail_university_name").val())?$("#submit_intent_of_use").attr("disabled","disableClick"):""===$.trim($("#extended_user_detail_course_name").val())?$("#submit_intent_of_use").attr("disabled","disableClick"):$("#student_radio").prop("checked")===$("#professor_radio").prop("checked")&&$("#student_radio").prop("checked")===$("#research_radio").prop("checked")?$("#submit_intent_of_use").attr("disabled","disableClick"):$("#submit_intent_of_use").removeAttr("disabled")}};$(document).ready(function(){"channels"===location.pathname.substring(1)&&usagePurposeModal.showHideUsageModal()});var widgetPreview={showPreviewPane:function(){$("#add_widget_modal_content_body").children("div").length>0?$("#add_widget_empty_text").attr("hidden",!0):$("#add_widget_empty_text").attr("hidden",!1)},showWidgetForm:function(){var e=$(".window-preview-container-selected").find("#widget-metadata-id").html(),t=$("#channel-metadata-id").html();ThingSpeak.Widget.getNewWidgetFormElements(t,e)},resetSettings:function(){$(".window-preview-container-selected").removeClass("window-preview-container-selected");$("#channel-metadata-id").html()},selectCurrentWindow:function(){$("#add_widget_modal_content_body > .window-preview-container-selected").each(function(e,t){t.classList.remove("window-preview-container-selected")}),document.getElementById("add_widget_next").disabled=!1}},widgetPreviewHelpers={gaugeToggleDisplayCheckBox:function(){$(document).on("click","#display_value_",function(){this.value=!!$(this).is(":checked")})}},widgetHelperFunctions={validateAndGetWidgetData:function(e,t,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"",a="#widget_params_config_"+i;switch(Number(e)){case 0:return!!widgetHelperFunctions.isGaugeValid(a,i,t,n)&&ThingSpeak.Widget.getGaugeParams(i);case 1:return!!widgetHelperFunctions.isNumericDisplayValid(a,i,n)&&ThingSpeak.Widget.getNumericDisplayParams(i);case 2:return ThingSpeak.Widget.getLampIndicatorParams(i);case 3:return ThingSpeak.Widget.getImageDisplayParams(i);default:return!1}},getWidgetWindow:function(e,t,n){var i=$(".window-preview-container-selected")[0];$("#channel-metadata-id").html();return{public_flag:n,content_type:$(i).attr("content-type"),content_id:$(i).attr("content-id"),widget_type:e,parameters:t}},isGaugeValid:function(e,t,n,i){var a=!0;return widgetHelperFunctions.isGaugeMinMaxInvalid(e,t)&&(a=!1,n.show()),widgetHelperFunctions.isUnitInvalid(e,t)&&(a=!1,i.show()),a},isNumericDisplayValid:function(e,t,n){var i=!0;return widgetHelperFunctions.isUnitInvalid(e,t)&&(i=!1,n.show()),i},updateName:function(e,t){t=t!=undefined?t:"";var n=$(e).find("#name_"+t)[0].value;t="#window_"+t;$(t+" .window-title").text(n)},isGaugeMinMaxInvalid:function(e,t){t=t!=undefined?t:"";var n=$(e).find("#min_"+t)[0].value,i=$(e).find("#max_"+t)[0].value;return widgetHelperFunctions.isMaxMinInvalid(n,i)},isMaxMinInvalid:function(e,t){return Number(e)>=Number(t)},isUnitInvalid:function(e,t){var n=$(e).find("#units_"+t)[0].value;return""!==n&&!/([^0-9])$/.test(n)},hideGaugeMinMaxError:function(e){$("#"+$(e).parents()[4].id).find("#gauge_min_max_error").hide()},hideUnitsError:function(e){$("#"+$(e).parents()[4].id).find("#units_error").hide()},gaugePlusButtonHelper:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",n=$("#range_meta_key_"+t).html(),i=Math.floor(9e5*Math.random())+1e5,a=Number(document.getElementById("range_meta_key_"+t).innerHTML);rangeLabel=0===a?"Range":"";var r="<tr><td class='widget-form-label widget-table-cells'><label class='col-form-label'>"+rangeLabel+" </label></td><td class='widget-table-cells'><input class='form-control' type='number' step='any' name='range_start_"+n+"' value='0'></td><td class='widget-table-cells'><input class='form-control' type='number' step='any' name='range_end_"+n+"' value='0'></td><td class='widget-table-cells'><input class='form-control form-control-color' value=#"+i+" name='range_color_"+n+"' type='color'></input></td><td name='"+t+"' class='color-range-row'><span id ='range_close_icon_"+n+"'class='close' aria-hidden='true'>&times;</span></td></tr>";document.getElementById(e).insertAdjacentHTML("beforeend",r),""!=document.getElementById("range_meta_key_"+t)&&(document.getElementById("range_meta_key_"+t).innerHTML=Number(n)+1)}};ThingSpeak.Window=function(){function e(e,t){return this.initialize=function(e,t){for(var n in e)this[n]=e[n];if(null!==this.html&&$("#windows_container").append($.parseHTML(this.html)),this.container=$("#window_"+this.id),this.iframeModal=$("#window_iframe_modal_"+this.id),this.iframe=$("#window_iframe_"+this.id),t){if(this.optionsModal=$("#window_options_modal_"+this.id),this.options_json=JSON.parse(this.options_json),$(this.container).find("#remove_window_"+this.id).click(this.remove.bind(this)),$("#window_options_modal_save_"+this.id).click(this.update_options.bind(this)),$("#window_widget_options_modal_save_"+this.id).click(this.update_widget_params.bind(this)),$("#widget_options_modal_open_"+this.id).click(this.widget_options_modal_open.bind(this)),$(this.optionsModal).on("hidden.bs.modal",this.reset_options.bind(this)),"widget"==this.content_type){var i=this.id;$("#window_widget_options_modal_"+i).on("shown.bs.modal",function(){$(document).on("click","#display_value_"+i,function(){this.value=!!$(this).is(":checked")})}.bind(this)),$(document).on("click","#gauge_add_range_"+i,function(){var e="widget_params_config_"+i;widgetHelperFunctions.gaugePlusButtonHelper(e,i)})}$(this.optionsModal).find(".mutuallyexclusive").change(function(e){var t=$(e.target),n=t.attr("id");t.parents("div.modal-body").find(".mutuallyexclusive").each(function(e,t){t.id!==n&&$(t).val("")})}),this.reset_options()}return this},this.widget_options_modal_open=function(){$(".error_banner").hide();var e=this.id,t=this.channel_id,n=this.content_id,i="widget_options_modal_content_body_",a="/channels/"+t+"/widgets/"+n+"/edit.json";$("#"+i).hide(),$.ajax({method:"GET",url:a,success:function(t){t.widget_type===ThingSpeak.Widget.WIDGET_TYPE.GAUGE&&(t.parameters=this.insert_display_value(t.parameters)),$("#"+i).show(),ThingSpeak.Widget.constructConfigModal({params:JSON.parse(t.parameters),enabled_fields:t.enabled_fields,image_channels:t.image_channels},t.widget_type,i,e)}.bind(this),error:function(){$("#"+i).innerHTML="Failed to fetch value from the server."}})},this.insert_display_value=(e=>{const t=JSON.parse(e);if("display_value"in t)return e;{const e=Object.entries(t),n=["display_value","true"];e.splice(4,0,n);const i=Object.fromEntries(e);return JSON.stringify(i)}}),this.update_widget_params=function(){var e=$("#widget_type_metadata_"+this.id).html(),t=$("#window_widget_options_modal_"+this.id).find("#gauge_min_max_error"),i=$("#window_widget_options_modal_"+this.id).find("#units_error"),a=widgetHelperFunctions.validateAndGetWidgetData(e,t,i,this.id);if(!a)return!1;n.updateWidget(this.id,this.content_id,this.channel_id,a)},this.update_options=function(){var e=function(){var e={},t=function(){var t=this.id.split("_")[1],n=$(this).val();""!=(n="string"==typeof n?n.trim():n)&&(e[t]=n)};return this.optionsModal.find(".form-control, .form-select").each(t),e}.bind(this),t=function(e){this.iframe_html=e.iframe_html,this.iframe_src=e.iframe_src,this.options=e.options,this.options_json=JSON.parse(e.options_json),$(this.iframe)[0].src=this.iframe_src,$(this.iframeModal).find("pre").text(this.iframe_html);var t=this.iframe_src.replace("?size=iframe","?height=auto&width=auto");$("#chart_page_"+this.id).attr("href",t),$(this.optionsModal).modal("hide")}.bind(this),n={window_update:"chart_options",options:e()},i=function(e){switch(e.status){case 401:location.href="/login";break;default:location.reload()}};this.post(n,"json",t,i)},this.reset_options=function(){var e=this.options_json,t=function(){var t=this.id.split("_")[1];$(this).val(e[t])};this.optionsModal.find(".form-control").each(t),this.optionsModal.find(".form-select").each(t)},this.remove=function(){var e=!0;if("widget"==this.content_type&&(e=confirm("Are you sure you want to delete this widget?")),e){$(this.container).remove();var t={window_update:"remove"};this.post(t,"script")}},this.post=function(e,t,n,i){$.ajax({method:"PUT",url:this.url,data:e,dataType:t}).done(n).fail(i)},this.initialize(e,t)}var t=function(e,t){data={window:t},$.ajax({method:"POST",url:"/channels/"+e+"/windows/create_widget",data:data,dataType:"script",error:function(e){400==e.status&&n.showErrorBanner(e)}})},n={updateWidget:function(e,t,i,a){widgetHelperFunctions.updateName("#widget_params_config_"+e,e);var r="/channels/"+i+"/widgets/"+t,o={paramData:a};$.ajax({method:"PUT",data:o,url:r,success:function(){document.getElementById("window_iframe_"+e).src+=""},error:function(e){400==e.status&&n.showErrorBanner(e)}})},showErrorBanner:function(e){document.getElementById("widget-config-err-msg").innerHTML=JSON.parse(e.responseText).error_message,$("#invalid_widget_parameter").show()}};return{init:function(t,n){return new e(t,n)},addVisualizations:function(e,t){data={windows:JSON.stringify(t)},$.ajax({method:"POST",url:"/channels/"+e+"/windows",data:data,dataType:"script"})},addWidgetWindow:t}}(),$(document).ready(function(){function e(){1==visualization_public_flag?($("#url_checkbox").attr("checked","checked"),r()):($("#url_checkbox").removeAttr("checked"),o())}if(elementPresent($("#channel_ids"))||elementPresent($("#visualization_url_div"))){if(elementPresent($("#results_container"))&&pluginDisplaySettings.hidePlotAndCodeOutput(),elementPresent($("#channel_listings_parent_div"))&&(pluginDisplaySettings.populateShowChannels(),pluginDisplaySettings.toggleFontAwesomePlusSign()),elementPresent($("#channel_ids"))){JSON.parse($("#channel_ids").val());var t=JSON.parse($("#public_channel_ids").val()),n=$("#visualization_is_private_text").val()}var i={displaySharingError:function(){$("#visualization_name_empty_error").show()},displayFlagSaveError:function(){$("#visualization_flag_save_error").show()}},a={setCheckbox:function(){auto_update_matlab_visualization?$("#auto_update_checkbox").attr("checked","checked"):$("#auto_update_checkbox").removeAttr("checked")},savePreference:function(e){var t=auto_update_matlab_visualization_url,n={auto_update_matlab_visualization:e};$.ajax({url:t,method:"PUT",data:n}).fail(function(){alerts.displayErrorAlert("auto_update_matlab_visualization_save_error")})}},r=function(){$("#visualization_URL").prop("placeholder",""),$("#visualization_URL").prop("value",visualization_public_url),document.getElementById("visualization_URL").style.cursor="default",$("#copy_button").show(),$("#visualization_child_div").addClass("input-group")},o=function(){$("#visualization_URL").prop("placeholder",""),$("#visualization_URL").prop("value",""),document.getElementById("visualization_URL").style.cursor="not-allowed",$("#copy_button").hide()};elementPresent($("#visualization_url_div"))&&e(),elementPresent($("#visualization_auto_update"))&&(a.setCheckbox(),$("#auto_update_checkbox").click(function(){a.savePreference(this.checked)})),$("#auto_update_matlab_visualization_save_error_close").on("click",function(){alerts.hideBanners(this.parentElement.id)}),$("#visualization_text_field").on("change",function(){$(this).val().trim()?(saveType="mouseClick",this.form.save.click()):i.displaySharingError()}),$("#visualization_text_field").on("keypress",function(e){13==e.keyCode&&(e.preventDefault(),$(this).val().trim()?(saveType="enter",this.form.save.click()):i.displaySharingError())}),$("#url_checkbox").on("click",function(){if(this.checked){if(visualization_public_flag=!0,elementPresent($("#channel_ids")))for(var e=0;e<t.length;e++)$("#public_"+t[e]).attr("disabled",!1).removeAttr("title")}else if(visualization_public_flag=!1,elementPresent($("#channel_ids")))for(e=0;e<t.length;e++)$("#public_"+t[e]).attr("checked",!1).attr("title",n).attr("disabled",!0);s(!visualization_public_flag),l()});var s=function(e){1==e?o():r()},l=function(){var e=save_public_flag_url,t={public_flag:visualization_public_flag};$.ajax({url:e,method:save_public_flag_url_http_verb,data:t}).fail(function(){i.displayFlagSaveError()})};elementPresent($("#channel_ids"))&&($.tablesorter.addParser({id:"checkbox",is:function(){return!1},format:function(e,t,n){return $(n).children().last().is(":checked")?1:0},type:"numeric"}),$("#add_to_channel_table").tablesorter({headers:{2:{sorter:"checkbox"},3:{sorter:"checkbox"}},widgets:["stickyHeaders"],widgetOptions:{stickyHeaders_attachTo:".add-to-channel-table"},initialized:function(e){var t=!1;$(e).find("input[type=checkbox]").each(function(){$(this).bind("change",function(){$(e).trigger("updateCell",[$(this).closest("td")[0],t])})})}}))}});elementPresent=function(e){return"string"==typeof e?0!==$(e).length:0!==e.length};var pluginDisplaySettings={populateShowChannels:function(){$("#channels_list").html(""),selected=!1;for(var e,t=document.getElementById("add_to_channel_table"),n=1;e=t.rows[n];n++){arr=[];for(var i,a=0;i=e.cells[a];a++)arr[a]=a<2?i.innerHTML:i.getElementsByTagName("input")[1].checked;channel_name=arr[0],channel_id=arr[1],private_view_checkbox_val=arr[2],public_view_checkbox_val=arr[3],is_private=!0===private_view_checkbox_val?"private view":"",""===is_private?is_public=!0===public_view_checkbox_val?"public view":"":is_public=!0===public_view_checkbox_val?", public view":"",1!=(""===is_private&&""===is_public)&&(selected=!0,"private view"===is_private?$("#channels_list").append('<li class="list-group-item list-group-channels list-group-item-light"><a href="/channels/'+channel_id+'/private_show">'+channel_name+"</a> ("+channel_id+") - "+is_private+is_public+"</li>"):$("#channels_list").append('<li class="list-group-item list-group-channels list-group-item-light"><a href="/channels/'+channel_id+'/">'+channel_name+"</a> ("+channel_id+") - "+is_public+"</li>"))}selected||($("#channels_list").html(""),$("#channels_list").append('<li class="list-group-item list-group-channels list-group-item-light"> None </li>'))},toggleFontAwesomePlusSign:function(){$(".collapse").on("show.bs.collapse",function(){$(this).parent().find(".fa").removeClass("fa-plus").addClass("fa-minus")}).on("hide.bs.collapse",function(){$(this).parent().find(".fa").removeClass("fa-minus").addClass("fa-plus")})},hidePlotAndCodeOutput:function(){is_error?($("#feval_container").removeClass("d-none"),$("#eval_container").removeClass("d-none")):($("#feval_container").addClass("d-none"),$("#eval_container").addClass("d-none"))}},usageVisualizationCharts=null;UsageVisualizations=function(){function e(e,t){var n=new Date;n=new Date(n.getFullYear(),n.getMonth(),n.getDate());for(var i=0,a=0,r=0;r<e.units.length;r++)if(e.units[r].endDate!==undefined&&new Date(e.units[r].endDate).getTime()+86400>=n.getTime()&&e.units[r].qty!==undefined&&(i+=e.units[r].qty*t,e.units[r].usages!==undefined))for(var o=0;o<e.units[r].usages.length;o++)if(e.units[r].usages[o].months!==undefined)for(var s=0;s<e.units[r].usages[o].months.length;s++)e.units[r].qty>0&&(a+=e.units[r].usages[o].months[s]);var l={};return l[0]=i,l[1]=a,l}function t(t,n){var i={0:"Invalid Date",1:"Unknown Monthly Usage"},a=new Date,o=new Date(a.getTime()-30*r);o<new Date("2016-12-05")&&(o=new Date("2016-12-05"));var s=o.getYear()+1900,l=a.getMonth()-1,d=o.getMonth();if(l<1&&(l=12),t===undefined||t.units===undefined)return i;for(var u=0,c=[],h=0,p=0;p<t.units.length;p++)if(t.units[p].usages!==undefined)for(var f=0;f<t.units[p].usages.length;f++)if(t.units[p].usages[f].year!==undefined&&t.units[p].usages[f].year>=s&&t.units[p].usages[f].months!==undefined)for(var m=0;m<t.units[p].usages[f].months.length;m++)if(m>=d&&m<=l){var g=new Date(t.units[p].endDate);t.units[p].qty>0&&g>=o&&(c[h]=[t.units[p].usages[f].year,m],h+=1,u+=t.units[p].usages[f].months[m])}var _,v=[];for(p=0;p<c.length;p++){_=0;for(f=0;f<v.length;f++)c[p][0]===v[f][0]&&c[p][1]===v[f][1]&&(_=1);0===_&&v.push(c[p])}var y=0;v.length>0&&(y=u/v.length);var b=e(t,n),w=b[0],$=b[1],x=new Date((new Date).getTime()+366*r);return y>0&&(x=new Date((new Date).getTime()+30*r*Math.floor((w-$)/y))),"Invalid Date"===x.toDateString()&&(x=new Date((new Date).getTime()+366*r)),i[0]=x,i[1]=y,i}function n(e,n,i){function a(e,t){let n=function(e){return e>200?e-200:e+20};Be.transition().duration(200).style("opacity",.8),Be.html(`<b>${t.data[0]}</b><br>`+`${t.key}: ${t[1]-t[0]}<br>`+`Total: ${Ae[t.data[0]]}`).style("left",n(e.pageX)+"px").style("top",e.pageY+20+"px").style("opacity",.8).style("visibility","visible")}function d(){Be.transition().duration(1e3).style("opacity",0),Be.transition().delay(1e3).style("visibility","hidden")}function u(){je.select(".x-axis").remove(),je.select(".y-axis").remove(),je.select(".stacked-chart").remove(),je.selectAll(".tick-lines").remove()}function c(e){const t=d3.stack().keys(d3.union(e.map(e=>e.name))).value(([,e],t)=>e.get(t).usage)(d3.index(e,e=>e.month,e=>e.name)),n=d3.scaleBand().domain(Ne).range([qe.left,Re-qe.right]).padding(.1),i=d3.scaleLinear().domain([0,d3.max(t,e=>d3.max(e,e=>e[1]))]).rangeRound([Fe-qe.bottom,qe.top]);je.append("g").attr("transform",`translate(0,${Fe-qe.bottom})`).attr("class","x-axis").call(d3.axisBottom(n).tickSizeOuter(0)).call(e=>e.selectAll(".domain, .tick line").remove()).selectAll("text").attr("class","monthly-x-axis-ticks"),je.append("g").attr("transform",`translate(${qe.left},0)`).attr("class","y-axis").call(d3.axisLeft(i).ticks(5,"s")).call(e=>e.selectAll(".domain").remove()).call(e=>e.selectAll(".domain, .tick").classed("y-axis-label",!0)),je.append("g").attr("class","stacked-chart").lower().selectAll().data(t).join("g").attr("fill",e=>Ue.get(e.key)).selectAll("rect").data(e=>e.map(t=>(t.key=e.key,t))).join("rect").attr("x",e=>n.bandwidth()/4+n(e.data[0])).attr("y",e=>i(e[1])).attr("height",e=>i(e[0])-i(e[1])).attr("width",n.bandwidth()/2).on("mouseover",a).on("mouseleave",d),i.ticks(5,"s").forEach(function(e){je.append("line").attr("y1",i(e)).attr("x1",0).attr("y2",i(e)).attr("x2",Re).attr("stroke","#e0e0e0").attr("stroke-width",1).attr("transform",`translate(${qe.left},0)`).attr("class","tick-lines").lower()})}var h=0,p=3e6,f=0,m=1,g=0;i!==undefined&&i.userType!==undefined&&(h=parseInt(i.userType)),i!==undefined&&i.number_of_messages_per_unit!==undefined&&(p=parseInt(i.number_of_messages_per_unit)),i!==undefined&&i.display_recommended_units!==undefined&&(f=parseInt(i.display_recommended_units)),i!==undefined&&i.proposed_num_of_units!==undefined&&(m=parseInt(i.proposed_num_of_units),g=1),m<1&&(m=1);let _=[];if(e===undefined)return 1===f?d3.select("#"+n).text(rI18n.monthly_insufficient_data_or_number).attr("class","no-chart-prompt"):d3.select("#"+n).text(rI18n.monthly_insufficient_data).attr("class","no-chart-prompt"),m;if(e.units===undefined||0===e.units.length)return d3.select("#"+n).text(rI18n.monthly_license_no_unit).attr("class","no-chart-prompt"),m;var v=0;for(M=0;M<e.units.length;M++)e.units[M].endDate!==undefined&&e.units[M].qty>0&&e.units[M].usages.length>0&&(v+=1);if(0===v)return 1===f?d3.select("#"+n).text(rI18n.monthly_insufficient_data_or_number).attr("class","no-chart-prompt"):d3.select("#"+n).text(rI18n.monthly_insufficient_data).attr("class","no-chart-prompt"),m;if(g&&f){var y={},b=new Date;y.id=0,y.qty=m;var w=b.getFullYear(),$=b.getMonth()+1,x=b.getDate();$<10&&($="0"+$),$>11&&($="01",w+=1),x<10&&(x="0"+x),y.startDate=w+"-"+$+"-"+x;var k=new Date(b.getTime()+365*r),E=k.getFullYear(),T=k.getMonth()+1,S=k.getDate();T<10&&(T="0"+T),T>11&&(T="01",E+=1),S<10&&(S="0"+S),y.endDate=E+"-"+T+"-"+S;var C=[{}];C[0].year=b.getFullYear(),C[0].months=[0,0,0,0,0,0,0,0,0,0,0,0],y.usages=C,e.units.push(y)}for(var D=new Date,P=new Date(e.units[0].endDate),M=0;M<e.units.length;M++){if(e.units[M].endDate!==undefined&&e.units[M].qty>0)D<(J=new Date(e.units[M].endDate))&&(D=new Date(J.getTime())),P>new Date(e.units[M].startDate)&&(P=new Date(e.units[M].startDate))}var L=t(e,p),A=L[0],R=L[1];("Invalid Date"===A.toDateString()||A>=D)&&(A=D);var F=new Date(Math.max(A.getTime(),D.getTime())+31*r),q=new Date(F-424*r);q<P&&(q=P);var I=[];for(M=0;M<e.units.length;M++)if(e.units[M].qty>0&&new Date(e.units[M].endDate)>=q){var N=[],j=[],U=q,B=0;if(0===e.units[M].usages.length){var O=q.getMonth(),H=q.getFullYear();do{j.push(0),U=new Date(H+"-"+s[O][0]+"-"+s[O][1]),(O+=1)>11&&(O=0,H+=1)}while(U<F);j.splice(j.length-1);var z=q.getMonth()+1;z<10&&(z="0"+z);var V=q.getDate();V<10&&(V="0"+V),N=[e.units[M].id,e.units[M].qty,e.units[M].startDate,e.units[M].endDate,q.getFullYear()+"-"+z+"-"+V,j,B]}else{for(le=0;le<e.units[M].usages.length&&e.units[M].usages[le].year!==q.getFullYear();le++);O=q.getMonth(),H=q.getFullYear();do{U=new Date(H+"-"+s[O][0]+"-"+s[O][1]),e.units[M].usages.length>le&&e.units[M].usages[le].months!==undefined&&e.units[M].usages[le].months.length>=O?j.push(e.units[M].usages[le].months[O]):j.push(0),(O+=1)>11&&(O=0,H+=1,le+=1)}while(U<F);j.splice(j.length-1);var W=q.getMonth()+1;W<10&&(W="0"+W);var Y=q.getDate();Y<10&&(Y="0"+Y),N=[e.units[M].id,e.units[M].qty,e.units[M].startDate,e.units[M].endDate,q.getFullYear()+"-"+W+"-"+Y,j,B]}for(var G=new Date(e.units[M].startDate),J=new Date(e.units[M].endDate),Q=0,K=0;K<e.units[M].usages.length;K++)for(var X=0;X<e.units[M].usages[K].months.length;X++){var Z=X>=G.getMonth(),ee=e.units[M].usages[K].year>=G.getFullYear(),te=X<q.getMonth(),ne=e.units[M].usages[K].year<=q.getFullYear();Z&&ee&&te&&ne&&(Q+=e.units[M].usages[K].months[X])}var ie=e.units[M].qty*p-Q;Q===p&&(N[6]=1),N[5][0]=ie,I.push(N)}for(M=0;M<I.length-1;M++)if(new Date(I[M][3])>new Date(I[M+1][3])){var ae=I[M];I[M]=I[M+1],I[M+1]=ae}var re=[],oe=[];for(M=0;M<I.length;M++){var se,le=1,de=0,ue=0,ce=new Date,he=ce.getMonth()+1;he<10&&(he="0"+he),ce=new Date(ce.getFullYear()+"-"+he+"-"+s[ce.getMonth()][1]);do{if(se=new Date(I[M][4]),de=new Date(I[M][4]).getMonth()+le,ue=Math.floor(de/12),(fe=(de%=12)+1)<10&&(fe="0"+fe),(se=new Date(se.getFullYear()+ue+"-"+fe+"-"+s[de][1]))>=ce)break;I[M][5][le]=I[M][5][le-1]-I[M][5][le],I[M][5][le]<0&&(I[M][5][le]=0),le+=1}while(se<ce&&se<new Date(I[M][3]));oe[M]=I[M].slice(),oe[M][5]=I[M][5].slice();for(var pe=0;pe<l;pe++)oe[M][5][pe]=0;var fe;B=0;(fe=de=new Date(oe[M][4]).getMonth()+1)<10&&(fe="0"+fe);var me=new Date(new Date(oe[M][4]).getFullYear()+"-"+fe+"-"+s[de-1][1]);if(new Date(oe[M][3])>new Date&&0===B&&(0===M||re.length>0&&me>re[0]?(oe[M][5][le]=I[M][5][le-1]-R,oe[M][5][le]<0&&(oe[M][5][le]=0,re[0]=me,re[1]=0)):oe[M][5][le]=I[M][5][le-1],oe[M][5][le]>0))for(pe=le+1;pe<l-1;pe++){ue=0,de=new Date(oe[M][4]).getMonth()+pe,ue=Math.floor(de/12),(fe=(de%=12)+1)<10&&(fe="0"+fe),me=new Date(new Date(oe[M][4]).getFullYear()+ue+"-"+fe+"-"+s[de][1]);var ge=new Date(oe[M][3]),_e=ge.getMonth()+1;_e<10&&(_e="0"+_e);var ve=ge.getUTCDate();if(ve<10&&(ve="0"+ve),ge=new Date(ge.getFullYear()+"-"+_e+"-"+ve),me.getMonth()>ge.getMonth()&&me.getFullYear()>=ge.getFullYear()){re[0]=new Date(me.getTime()),oe[M][5][pe-1]>R?re[1]=0:re[1]=oe[M][5][pe-1]-R;break}if(0===M||re.length>0&&me>=re[0]?oe[M][5][pe]=oe[M][5][pe-1]-R:oe[M][5][pe]=oe[M][5][pe-1],oe[M][5][pe]<0&&(oe[M][5][pe]=0,0===B)){re[0]=new Date(me.getTime()),re[1]=-oe[M][5][pe],B=1;break}}}for(M=0;M<I.length-1;M++)if(new Date(I[M][3])>new Date(I[M+1][3])){ae=I[M];I[M]=I[M+1],I[M+1]=ae;var ye=oe[M];oe[M]=oe[M+1],oe[M+1]=ye}var be=0;do{be=0;for(M=0;M<I.length;M++)1===I[M][6]&&(I.splice(M,1),oe.splice(M,1),be=1)}while(1===be);for(M=0;M<I.length;M++){var we=[];q=new Date(I[M][4]);for(le=0;le<l;le++){var $e=q.getFullYear(),xe=q.getMonth()+le;$e+=Math.floor(xe/12),xe%=12,we.push([new Date($e+"-"+s[xe][0][0]+"-"+s[xe][0][1]),I[M][5][le]])}var ke={};ke.name=3==h?"Remaining messages (purchase "+I[M][2]+")":"Remaining messages (free messages start date "+I[M][2]+")",ke.data=we,ke.color="rgba("+o[M%o.length][0]+","+o[M%o.length][1]+","+o[M%o.length][2]+",1)",_.push(ke)}for(M=0;M<oe.length;M++){we=[],q=new Date(oe[M][4]);for(le=0;le<l;le++)$e=q.getFullYear(),xe=q.getMonth()+le,$e+=Math.floor(xe,12),xe%=12,we.push([new Date($e+"-"+s[xe][0][0]+"-"+s[xe][0][1]),oe[M][5][le]]);var Ee={};Ee.name=3==h?"Projected# messages remaining (purchase "+oe[M][2]+")":"Projected# messages remaining (free messages renewal date "+oe[M][2]+")",Ee.data=we,Ee.color="rgba("+o[M%o.length][0]+","+o[M%o.length][1]+","+o[M%o.length][2]+",0.25)",_.push(Ee)}var Te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Se=new Date(q),Ce=Se.getMonth(),De=Se.getFullYear(),Pe=0;let Me=[];for(;Pe<l;)Me.push(Te[Ce]+" "+De),++Ce>11&&(Ce=0,De+=1),Pe++;_.reverse();let Le=[],Ae={};for(let e=0;e<_.length;e++){const t=_[e].name,n=_[e].color;for(let i=0;i<_[e].data.length;i++)Le.push({month:Me[i],name:t,usage:_[e].data[i][1],color:n}),Ae.hasOwnProperty(Me[i])?Ae[Me[i]]+=_[e].data[i][1]:Ae[Me[i]]=_[e].data[i][1]}Le.sort((e,t)=>{return new Date(e.month+" 1")-new Date(t.month+" 1")});const Re=928,Fe=500,qe={top:10,right:10,bottom:20,left:60};let Ie=new Set(Le.map(e=>e.name));const Ne=Le.map(e=>e.month),je=d3.select("#"+n).append("svg").attr("width",Re).attr("height",Fe).attr("viewBox",[0,0,Re,Fe]).attr("style","max-width: 100%; height: auto;"),Ue=new Map(Le.map(e=>[e.name,e.color])),Be=d3.select("#"+n).append("div").attr("class","tooltip");c(Le),je.append("text").attr("y",0).attr("x",0-Fe/2).attr("dy","1em").attr("class","y-axis-title").text(rI18n.daily_message_remaining);const Oe=je.append("g").attr("class","legend").attr("id","legend-container").selectAll(".legend").data(Ue.keys()).enter().append("g").attr("transform",(e,t)=>`translate(0,${20*t})`);return Oe.raise(),Oe.append("rect").attr("x",Re-18).attr("class","legend-box").attr("fill",e=>Ue.get(e)),Oe.append("text").attr("x",Re-24).attr("y",9).attr("dy",".35em").attr("class","legend-text").text(e=>e).on("click",function(){let e=d3.select(this);const t=e.text(),n=Le.filter(e=>e.name==t);if(1==e.style("opacity")){e.style("opacity",.3),Ie["delete"](t);for(let e=0;e<n.length;e++)Ae[n[e].month]-=n[e].usage;u(),c(Le.filter(e=>Ie.has(e.name)))}else{e.style("opacity",1),Ie.add(t);for(let e=0;e<n.length;e++)Ae[n[e].month]+=n[e].usage;u(),c(Le.filter(e=>Ie.has(e.name)))}}),g&&f&&e.units.pop(),m}function i(e,t,n,i){function a(e,t){let n=function(e){return e>200?e-200:e+20};x.transition().duration(200).style("opacity",.8);let i=new Date(t.date);const a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];x.html(`${t.value} messages used on ${i.getDate()}-${a[i.getMonth()]}-${i.getFullYear()}<br>`).style("left",n(e.pageX)+"px").style("top",e.pageY+20+"px").style("opacity",.8).style("visibility","visible").style("position","absolute")}function o(){x.transition().duration(1e3).style("opacity",0),x.transition().delay(1e3).style("visibility","hidden")}n!==undefined&&n.userType!==undefined&&parseInt(n.userType),n!==undefined&&n.number_of_messages_per_unit!==undefined&&parseInt(n.number_of_messages_per_unit),n!==undefined&&n.display_recommended_units!==undefined&&parseInt(n.display_recommended_units),n!==undefined&&n.proposed_num_of_units!==undefined&&parseInt(n.proposed_num_of_units),i=i!==undefined?parseInt(i):Infinity;var s=[],l=new Date;l=new Date(l.getFullYear(),l.getMonth(),l.getDate(),0,-1*l.getTimezoneOffset());var u=new Date(l-d*r);if(e===undefined||e.startDate===undefined||e.datapoints===undefined||0===e.datapoints)return void d3.select("#"+t).text(rI18n.daily_insufficient_data).attr("class","no-chart-prompt");for(var c=new Date(e.startDate).getTime(),h=Math.round((u-c)/r),p=Math.max(0,h),f=0,m=p;m<e.datapoints;m++){var g=new Date(u.valueOf()+(m-h)*r);s[m-p]=[g.getTime(),e.usages[m]],parseInt(e.usages[m])>f&&(f=e.usages[m])}if(0===s.length&&(s[0]=[u.getTime(),0]),s.length<d)for(m=s.length;m<d;m++)g=new Date(s[m-1][0]+1*r),s[m]=[g.getTime(),0];const _={top:10,right:60,bottom:20,left:20},v=$("#"+t).width()-_.left-_.right,b=v/2,w=d3.select("#"+t).append("svg").attr("class","chart-container").attr("height",b+_.top+_.bottom).append("g").attr("width","100%").attr("height",b+_.top+_.bottom),x=d3.select("#"+t).append("div").attr("class","tooltip");let k=s.map(e=>({date:d3.timeFormat("%d-%b-%Y")(new Date(e[0])),value:e[1]})),E=d3.scaleBand().domain(k.map(e=>e.date)).range([0,v]).padding(.1);w.append("g").attr("class","x-axis").attr("transform",`translate(${_.left+_.right/2},${b-_.top-_.bottom})`).call(d3.axisBottom(E).tickFormat((e,t)=>t%2==0?e:"").tickSizeOuter(0)).selectAll("text").attr("class","daily-x-axis-ticks").attr("dx","-.8em").attr("dy",".15em"),d3.selectAll(".x-axis .tick").filter(function(){return""===d3.select(this).select("text").text()}).remove();const T=Math.max(1.2*d3.max(k,e=>e.value),10);y=d3.scaleLinear().domain([0,T]).range([b,0]),y.ticks(5,"s").forEach(function(e){w.append("line").attr("y1",y(e)).attr("x1",0).attr("y2",y(e)).attr("x2",v).attr("stroke","#e0e0e0").attr("stroke-width",1).attr("transform",`translate(${_.left+_.right/2},${-_.top-_.bottom})`).lower()}),w.append("g").attr("class","y-axis").attr("transform",`translate(${_.left+_.right/2},${-_.top-_.bottom})`).call(d3.axisLeft(y).ticks(5).tickSizeOuter(0)).call(e=>e.selectAll(".domain").remove()).call(e=>e.selectAll(".domain, .tick").classed("y-axis-label",!0)),w.append("text").attr("y",_.left/2).attr("x",0-b/2).attr("dy","1em").attr("class","y-axis-title").text(rI18n.daily_message_usage),w.append("g").datum(k).attr("id","visualization_chart").selectAll("rect").data(e=>e).enter().append("rect").attr("x",e=>E(e.date)+E.bandwidth()/4).attr("y",e=>y(e.value)).attr("width",E.bandwidth()/2).attr("height",e=>b-y(e.value)).attr("fill","rgba(6,154,71,1)").attr("transform",`translate(${_.left+_.right/2},${-_.top-_.bottom})`).on("mouseover",a).on("mouseleave",o),f>.95*i&&(w.append("line").attr("class","limit-line").attr("x1",0).attr("y1",y(i)).attr("x2",v).attr("y2",y(i)).attr("transform",`translate(${_.left+_.right/2},${-_.top-_.bottom})`),w.append("text").attr("x",_.left+_.right/2).attr("y",y(i)-5).text(rI18n.daily_recommend_usage).attr("class","limit-line-text").attr("transform",`translate(${_.left+_.right/2},${-_.top-_.bottom})`))}function a(t,n,i){var a=3e6;i!==undefined&&i.userType!==undefined&&parseInt(i.userType),i!==undefined&&i.number_of_messages_per_unit!==undefined&&(a=parseInt(i.number_of_messages_per_unit)),i!==undefined&&i.display_recommended_units!==undefined&&parseInt(i.display_recommended_units),i!==undefined&&i.proposed_num_of_units!==undefined&&parseInt(i.proposed_num_of_units);var r={};if(r.Date=new Date((new Date).setFullYear((new Date).getFullYear()+1)),r.DateType="Expiration Date",r.DailyUsageRate=0,n===undefined||n.usages===undefined||0===n.usages.length)return r;if(t===undefined||t.units===undefined||0===t.units.length)return r;for(var o=new Date("2016-12-05"),s=0;s<t.units.length;s++)if(t.units[s].qty>0&&t.units[s].endDate!==undefined&&new Date(t.units[s].endDate)>o){var l=Date.UTC(t.units[s].endDate.split("-")[0],t.units[s].endDate.split("-")[1]-1,t.units[s].endDate.split("-")[2]);o=new Date(l+60*new Date(Date.now()).getTimezoneOffset()*1e3)}var d=new Date,u=d.getDate(),c=0;for(s=1;s<u;s++)c+=parseInt(n.usages[n.usages.length-s]);var h=e(t,a),p=h[0]-(h[1]+c),f=0,m=0,g=0,_=0;for(s=1;s<31;s++)f+=parseInt(n.usages[n.usages.length-s]),s<16&&(m+=parseInt(n.usages[n.usages.length-s])),s<8&&(g+=parseInt(n.usages[n.usages.length-s])),s<2&&(_+=parseInt(n.usages[n.usages.length-s]));var v=Math.ceil(f/30),y=Math.ceil(m/15),b=Math.ceil(g/7),w=_,$=1e-6;0==v&&(v=$),0==y&&(y=$),0==b&&(b=$),0==w&&(w=$);var x=Math.floor(p/v),k=Math.floor(p/y),E=Math.floor(p/b),T=Math.floor(p/w);x>365&&(x=365),k>365&&(k=365),E>365&&(E=365),T>365&&(T=365);var S=(new Date).getTime(),C=864e5,D=new Date(S+x*C),P=v;return p<15*y&&(D=new Date(S+k*C),P=y),p<7*b&&(D=new Date(S+E*C),P=b),p<w&&(D=new Date(S+T*C),P=w),(D<d||p<0)&&(D=d),o<D||o.getFullYear()==D.getFullYear()&&o.getMonth()==D.getMonth()&&o.getDate()==D.getDate()?(r.Date=o,r.DateType="Expiration Date"):(r.Date=D,r.DateType="Exhaustion Date"),r.DailyUsageRate=Math.round(P),r}var r=864e5,o=[[0,114,189],[217,83,25],[237,177,32],[126,47,142],[119,172,48],[77,190,238],[162,20,47]],s=[["01",31],["02",28],["03",31],["04",30],["05",31],["06",30],["07",31],["08",31],["09",30],["10",31],["11",30],["12",31]],l=14,d=32;return{updateDailyUsageChart:i,updateMonthlyUsageChart:n,estimateExhaustionOrExpirationDate:a}}(),$(document).ready(function(){var e;0!==$("#sales_div").length&&(e=user_info.is_free_user?user_info.free_license_id:user_info.is_a_staff?user_info.staff_license_id:$("#select_license").is("label")?$("#select_license").html():$("#select_license").val(),loadAccountsPage(e),
$("#select_license").change(function(){loadAccountsPage($("#select_license").val())}))});var formatToLocale=function(e){return e=isNaN(parseInt(e))?"":e.toLocaleString()},accountsPageHelperFunctions={setLicenseType:function(e){for(i=0;i<license_types.length;i++)if(license_types[i].hasOwnProperty(e)){$("#license_type").html(license_types[i][e]);break}},setDivsForFreeUser:function(){$(".free_user_div").removeClass("d-none")},populateFreeUserTable:function(){var e,t,n,i={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},a=user_info.licenses[0].end_date.split("-");e=a[2],t=i[a[1]],n=a[0];var r=user_info.licenses[0].messages_remaining;$("#free_unit_expiration_date").html(e+" "+t+" "+n),$("#free_messages_available").html(formatToLocale(Math.round(user_info.free_messages_per_year))),$("#free_messages_remaining").html(formatToLocale(r)),null!=channel_data&&($("#free_channels_available").html(channel_data[3]),$("#free_channels_remaining").html(channel_data[2]))},setLicenseUnavailableText:function(){var e='<tr><td colspan="3"><span class="text-danger break-word">'+rI18n.license_details_tmp_unavail+"</span></td></tr>";$("#free_user_messages_table2").append(e)},setAccountsPageForFreeUser:function(){1==user_info.has_exhausted&&(is_shutOff=!0),accountsPageHelperFunctions.setDivsForFreeUser(),jQuery.isEmptyObject(user_info.licenses)?accountsPageHelperFunctions.setLicenseUnavailableText():accountsPageHelperFunctions.populateFreeUserTable(),$("#suggested_daily_usage_rate_free_user").html("&nbsp;"+formatToLocale(Math.round(user_info.free_messages_per_year/365))+"&nbsp;messages"),populateFreeUnitsLink(is_shutOff)},findChannelLimit:function(e,t){return offering_id_limit_hash[e]*t}},loadAccountsPage=function(e){null!=license_types&&accountsPageHelperFunctions.setLicenseType(e),setExhaustionAlertDefaults(),1==user_info.is_free_user?accountsPageHelperFunctions.setAccountsPageForFreeUser():jQuery.isEmptyObject(user_info.licenses)?$(".license_info_unavail_div").removeClass("d-none"):user_info.licenses.forEach(function(t){if(t.license_id==e){if(null!=t.has_exhausted&&(is_shutOff=!0),1==t.is_an_leu){is_leu=!0,1==t.is_an_nde_leu?$(".nde_leu_div").removeClass("d-none"):t.is_a_staff?$(".staff_div").removeClass("d-none"):$(".leu_div").removeClass("d-none");var n=!1;user_info.licenses.forEach(function(e){0==e.is_an_leu&&(n=!0)}),n?$(".pricing_link").hide():$(".pricing_link").show()}else 1==t.is_an_nde_admin?$(".nde_admin_div").removeClass("d-none"):$(".admin_div").removeClass("d-none"),drawUnitsTable(t,e),populatePurchaseUnitsLink(e);populateAlertMessages(e,is_shutOff)}}),drawMessageUsageCharts(e),populateLicenceCenterLink(e)},drawUnitsTable=function(e,t){e.is_an_nde_admin?(salesDiv=$("#sales_div_nde"),suggested_daily_rate=$("#suggested_daily_usage_rate_nde")):(salesDiv=$("#sales_div"),suggested_daily_rate=$("#suggested_daily_usage_rate")),salesDiv.find("table").remove();var n=[],i=0;user_info.licenses.forEach(function(e){if(e.license_id==t)return i+=1,n=e.units,!1});var a,r,o,s,l,d=0,u=[],c=[[0,114,189],[217,83,25],[237,177,32],[126,47,142],[119,172,48],[77,190,238],[162,20,47]],h=0,p=0,f=new Date(1970,1,1),m=new Date(1970,1,1),g=null;null!=channel_data&&(g=channel_data[4][t]);i=0;var _="",v="",y=!1,b="2019-02-13";n.forEach(function(e){expirationDateUTC=Date.UTC(e.end_date.split("-")[0],e.end_date.split("-")[1]-1,e.end_date.split("-")[2]),a=new Date(expirationDateUTC+60*new Date(Date.now()).getTimezoneOffset()*1e3),null!=g&&(a>=new Date?(y?v="N/A":(_=g[i][0],0===e.messages_remaining&&e.start_date<b?(v="N/A",y=!0):v=g[i][1]),i++):(_=accountsPageHelperFunctions.findChannelLimit(e.offering_id,e.qty),v=0)),r=(a.getDate()<10?"0":"")+a.getDate(),o=a.toLocaleString("en-us",{month:"short"}),s=a.getFullYear(),l=e.messages_allowed,messagesRemaining=e.messages_remaining,d+=messagesRemaining;var t="rgba("+c[h][0]+","+c[h][1]+","+c[h][2]+",1)",w="<table><colgroup><col class='col-sm-2 col-xs-6'><col class='col-sm-4 col-xs-12'></colgroup><tr><td class='text-start'><label>Units:</label><label style='font-weight: normal'>"+e.qty+"</label></td><td class='text-right'><label>Expiration Date: &nbsp</label><label style='font-weight: normal;'> "+r+" "+o+" "+s+"&nbsp;<i class='fa fa-square units_box' style=color:"+t+" aria-hidden='true'></i></label></td></tr>"+("<table class='table table-bordered table-sm text-center pricing_results'><colgroup><col class='col-sm-2 col-xs-6'><col class='col-sm-2 col-xs-6'><col class='col-sm-2 col-xs-6'></colgroup><thead class='text-center'><tr><th scope='col'></th><th scope='col' class='text-center'>Purchased</th><th scope='col' class='text-center'>Remaining</th></tr></thead><tbody><tr><th scope='row'>Messages</th><td>"+l+"</td><td>"+messagesRemaining+"</td></tr><th scope='row'>Channels</th><td>"+_+"</td><td>"+v+"</td></tr></tbody></table>");h=(h+1)%c.length,a>new Date?(salesDiv.append(w),a>m&&(m=a)):(p+=1,a>f&&(f=a,trHTMLMAX=w),p===n.length&&salesDiv.append(trHTMLMAX)),checkForLicenseProdId(u,e,a)}),u.forEach(function(e){checkForUnitExpiration(e)});var w=Math.abs((new Date).getTime()-m.getTime()),x=Math.ceil(w/864e5);user_info.suggestedDailyRate=Math.round(d/x),suggested_daily_rate.html("&nbsp;"+formatToLocale(user_info.suggestedDailyRate)+"&nbsp;messages")},checkForLicenseProdId=function(e,t,n){for(var i in e.push({key:t,value:n}),e)e[i].key.licensed_prod_id===t.licensed_prod_id&&1!=e.length&&e[i].key.id!=t.id&&checkDateForRenewal(e[i],n,e,i)},checkDateForRenewal=function(e,t,n,i){e.value<t?n.splice(i,1):n.splice(-1,1)},checkForUnitExpiration=function(e){var t=Math.abs(new Date(e.value).getTime()-(new Date).getTime()),n=Math.ceil(t/864e5),i=e.value.toISOString().split("T")[0]===(new Date).toISOString().split("T")[0];(e.value>new Date||i)&&n<=60&&renderRenewalsDiv(e)},renderRenewalsDiv=function(e){$("#purchase_units_link").addClass("btn-default"),$("#renew_units_link").show();const t=`\n    <div id="${e.key.id}renewals_div" class="alert alert-danger alert-dismissable renewals_expiration_alert" role="alert" style="display:none; clear:both">\n      <span class="dismiss" data-bs-dismiss="alert" aria-label="Close"><i class="fa fa-close"></i></span>\n      <span>User purchase made on \n        <strong><span name="renewal_start_date" id="${e.key.id}renewal_start_date"></span></strong>\n        is going to expire on: \n        <strong><span name="renewal_expiration_date" id="${e.key.id}renewal_expiration_date"></span></strong>. \n        <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>\n        <a id="${e.key.id}call_of_action_to_renew" class="exhaustion_alert" target="_blank" rel="noopener noreferrer">Renew units</a>\n      </span>\n    </div>\n    `;$("#exhaustion_div").append(t),$("#"+e.key.id+"renewal_start_date").text(moment(new Date(e.key.start_date)).format("LL")),$("#"+e.key.id+"renewal_expiration_date").text(moment(new Date(e.value)).format("LL")),populateRenewUnitsLink(e.key.id),$("#"+e.key.id+"renewals_div").show()},drawMessageUsageCharts=function(e){$("#spinner_daily").show(),$("#spinner_monthly").show();var t=!1,n=0;user_info.is_free_user||jQuery.isEmptyObject(user_info.licenses)||user_info.licenses.forEach(function(i){i.license_id==e&&(t=i.is_an_leu,n=i.total_remaining_messages_per_license)});var i={daily:undefined,monthly:undefined},a={userType:user_info.user_type};user_info.is_free_user?(a.number_of_messages_per_unit=user_info.free_messages_per_year,a.messages_remaining=user_info.licenses[0].messages_remaining):(a.number_of_messages_per_unit=user_info.messages_per_paid_unit,a.messages_remaining=n);var r=function(e){i.daily=e,s(i),$("#spinner_daily").hide(),UsageVisualizations.updateDailyUsageChart(e,"dailyMessageUsage",a,user_info.suggestedDailyRate)},o=function(e){i.monthly=e,s(i),$("#monthly_usage_tab").is(":visible")&&($("#spinner_monthly").hide(),UsageVisualizations.updateMonthlyUsageChart(e,"messageUnitUsage",a))},s=function(t){t.daily&&t.monthly&&checkMessageExhaustion(e,user_info,user_info.is_free_user,i,!0,a)},l=5e3,d={url:"/account/daily_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",timeout:l};$.ajax(d).done(r).fail(function(e){304!=e.status?$.ajax(d).done(r).fail(function(){$("#spinner_daily").hide(),$("#dailyMessageUsageTmpUnavail").show()}):($("#spinner_daily").hide(),$("#dailyMessageUsageTmpUnavail").show())}),monthlyAjaxOptions={url:"/account/monthly_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",timeout:l},$.ajax(monthlyAjaxOptions).done(o).fail(function(e){304!=e.status?$.ajax(monthlyAjaxOptions).done(o).fail(function(){$("#spinner_monthly").hide(),$("#messageUnitUsageTmpUnavail").show()}):($("#spinner_monthly").hide(),$("#messageUnitUsageTmpUnavail").show())})},populateLicenceCenterLink=function(e){var t=user_info.license_center_link;t=t.replace(":lid",encodeURIComponent(e)),$("#license_center_link").attr("href",t)},populateRenewUnitsLink=function(e){var t=user_info.licenses[user_info.licenses.length-1].license_id;renew_link=renew_units_link.replace(":lid",encodeURIComponent(t)),$("#"+e+"call_of_action_to_renew").attr("href",renew_link),$("#renew_units_link").attr("href",renew_link)};$(document).ready(function(){var e=-90;$(".flash").length>0&&($(".flash").on("click",function(){$(this).hide("slow")}),setTimeout(function(){$("div.flash.alert.alert-success").length>0&&$(".flash").hide("slow")},15e3)),$("#talkback_command_add").click(function(){$("#talkback_command_add_form").removeClass("d-none"),$("#talkback_command_add").addClass("d-none")}),$("#contact_link").click(function(){$("#contact_form").toggle()}),$(".tablesorter").length>0&&$(".tablesorter").tablesorter(),$("#userlogin_js").val("6H2W6QYUAJT1Q8EB"),$("input").not(".maxlength_exempt").attr("maxlength","80"),setTimeout(function(){if(""!==window.location.hash){var t=$(window.location.hash).offset().top+e;$(document).scrollTop(t)}},150)});